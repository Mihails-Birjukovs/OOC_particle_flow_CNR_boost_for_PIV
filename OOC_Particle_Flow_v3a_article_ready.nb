(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    200433,       4033]
NotebookOptionsPosition[    189057,       3842]
NotebookOutlinePosition[    189532,       3860]
CellTagsIndexPosition[    189489,       3857]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Implement MATLINK coupling with MATLAB \
PIVlab\[LineSeparator]https://www.mathworks.com/matlabcentral/fileexchange/\
27659-pivlab-particle-image-velocimetry-piv-tool-with-gui\
\>", "Item",
 CellChangeTimes->{{3.9284127132270365`*^9, 3.9284127486858397`*^9}, {
  3.930634649915332*^9, 
  3.9306346499163337`*^9}},ExpressionUUID->"893d54b5-4445-478c-a18d-\
2e20b9f448e6"],

Cell["Frame_1 -> Frame_001", "Item",
 CellChangeTimes->{{3.9284127132270365`*^9, 3.928412762446546*^9}, {
  3.9306345834130487`*^9, 
  3.9306345834140606`*^9}},ExpressionUUID->"1a0daef4-1570-453b-8368-\
2494e448c791"],

Cell["Improved boundary/static artifact treatment", "Item",
 CellChangeTimes->{{3.9284127132270365`*^9, 3.928412762446546*^9}, {
  3.930634584057334*^9, 
  3.9306345936522155`*^9}},ExpressionUUID->"2e1de900-b2f1-4da6-9582-\
6e5dc56ff84c"],

Cell["GPU-based BM3D filtering instead of Perona-Malik", "Item",
 CellChangeTimes->{{3.9284127132270365`*^9, 3.928412762446546*^9}, {
  3.930634584057334*^9, 
  3.930634623253045*^9}},ExpressionUUID->"514f196c-f212-468c-9aab-\
071db8706a6a"],

Cell["GPU-based NMM instead of the CPU version", "Item",
 CellChangeTimes->{{3.9284127132270365`*^9, 3.928412762446546*^9}, {
  3.930634584057334*^9, 
  3.9306346424802203`*^9}},ExpressionUUID->"1f362166-2180-4ddb-a4af-\
4aa6f3003502"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellLabel->
  "In[219]:=",ExpressionUUID->"80d80720-de6d-4268-b533-6b474d6cba92"],

Cell["\<\
Important:

For seamless automatic processing, do this:
1) Disable (using \[OpenCurlyDoubleQuote]Alt + /\[CloseCurlyDoubleQuote] to \
(un-)comment) all import cells except image import
2) Use memorized crop bounds (instructions below)

For checking & re-doing existing input:\[LineSeparator]Option 1: place the \
experiment folder with run subfolders into the \[OpenCurlyQuote]output\
\[CloseCurlyQuote] folder
Option 2: change the \[OpenCurlyQuote]mainOutputFolder\[CloseCurlyQuote] in \
\[OpenCurlyDoubleQuote]Initialization\[CloseCurlyDoubleQuote] to the main \
results folder\
\>", "Abstract",
 CellChangeTimes->{{3.888922906196766*^9, 3.8889229194346066`*^9}, {
  3.894804961323394*^9, 3.894804965269334*^9}, {3.930291325113571*^9, 
  3.9302913434852905`*^9}, {3.9306338576574726`*^9, 3.930634049619918*^9}, {
  3.9306340896974316`*^9, 3.9306340918488035`*^9}, {3.930634306369034*^9, 
  3.930634553288803*^9}, {3.930665276149782*^9, 3.9306653541020947`*^9}},
 FontSize->16,ExpressionUUID->"ef232dc1-b114-482f-a7d2-7734aeca2543"],

Cell["ALWAYS EVALUATE \[OpenCurlyQuote]Initialization\[CloseCurlyQuote] \
FIRST", "Abstract",
 CellChangeTimes->{{3.888922906196766*^9, 3.8889229194346066`*^9}, {
  3.894804961323394*^9, 3.894804965269334*^9}, {3.930291325113571*^9, 
  3.9302913434852905`*^9}},
 FontSize->24,ExpressionUUID->"f6b308f5-3e53-4055-b95c-362832c65f61"],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 
   3.890508677778922*^9}},ExpressionUUID->"0a7902ba-3100-4679-9380-\
02b3076e63e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbd", ":=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"packageDirectory", ":=", 
     RowBox[{
     "\"\<D:\\\\Science\\\\NMI (VTPMML)\\\\MHD Project\\\\Image \
Processing\\\\Mathematica Libraries & Packages\\\\Quantile \
Regression\\\\\>\"", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Import", "[", 
       RowBox[{"packageDirectory", "<>", "\"\<QuantileRegression.m\>\""}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"<<", "MaTeX`"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"Filling", "\[Rule]", "None"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"launchNukes", "[", "useKernels_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Kernels", "[", "]"}]}], "<", "#"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "-", 
          RowBox[{"Length", "@", 
           RowBox[{"Kernels", "[", "]"}]}]}], "//", "LaunchKernels"}], ",", 
        "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}], 
      "&"}], "@", "useKernels"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mainOutputFolder", "=", 
   RowBox[{"nbd", "<>", "\"\<Output\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "mainOutputFolder"}], ";"}], "//", 
   "Quiet"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"progress", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"TableForm", "@", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<Processing...\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"ProgressIndicator", "@", 
       RowBox[{"Dynamic", "[", 
        RowBox[{
         RowBox[{"x", "/", "y"}], "//", "N"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"Round", "@", "x"}]}], "<>", "\"\</\>\"", "<>", 
       RowBox[{"ToString", "@", "y"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ToString", "@", 
       RowBox[{"PercentForm", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "/", "y"}], "//", "N"}], ",", 
         RowBox[{"DefaultPrintPrecision", "\[Rule]", "1"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"memoryCheck", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"\"\<Memory in use: \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemoryInUse", "[", "]"}], "/", 
        RowBox[{"1024", "^", "3"}]}], "//", "N"}], "]"}], "<>", 
     "\"\< Gb\>\""}], "//", "Print"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"memoryCleanupStart", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Memory in use: \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemoryInUse", "[", "]"}], "/", 
           RowBox[{"1024", "^", "3"}]}], "//", "N"}], "]"}], "<>", 
        "\"\< Gb\>\""}], "//", "Print"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Unprotect", "@", "Out"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CloseKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ClearSystemCache", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"memoryCleanupFinalize", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "@", "Out"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Protect", "@", "Out"}], ";", "\[IndentingNewLine]", 
      RowBox[{"LaunchKernels", "@", "useKernels"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Memory in use after cleanup: \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemoryInUse", "[", "]"}], "/", 
           RowBox[{"1024", "^", "3"}]}], "//", "N"}], "]"}], "<>", 
        "\"\< Gb\>\""}], "//", "Print"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"useKernels", "=", 
   RowBox[{
    RowBox[{"2", "*", "$ProcessorCount"}], "-", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "@", "monitorCounter"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontSize", "=", "16"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8169304402015343`*^9, 3.8169304572329664`*^9}, {
   3.817297782007059*^9, 3.81729778360575*^9}, {3.817308232575077*^9, 
   3.8173082329091744`*^9}, {3.8173082654542065`*^9, 
   3.8173082661323175`*^9}, {3.8173083731116056`*^9, 3.817308436969288*^9}, 
   3.8173084714569016`*^9, 3.817308641528023*^9, {3.8215187351516724`*^9, 
   3.8215187451204844`*^9}, {3.8215212453537927`*^9, 
   3.8215212812414527`*^9}, {3.8215217470822363`*^9, 3.821521772298771*^9}, {
   3.821521813453446*^9, 3.821521857595766*^9}, {3.8215222341401415`*^9, 
   3.821522259318509*^9}, {3.82152326402353*^9, 3.8215232643347263`*^9}, {
   3.821530441037798*^9, 3.821530444877508*^9}, {3.821530481189026*^9, 
   3.82153057883045*^9}, {3.821542161396227*^9, 3.821542175551358*^9}, {
   3.8215580973521657`*^9, 3.8215581067121277`*^9}, {3.821605050390068*^9, 
   3.8216050553070993`*^9}, 3.8222976400725813`*^9, {3.8223704281181946`*^9, 
   3.8223704510386715`*^9}, {3.822370484639129*^9, 3.8223706107676973`*^9}, {
   3.8223706477507224`*^9, 3.8223706492089605`*^9}, {3.828688650553396*^9, 
   3.8286886604331484`*^9}, {3.8286887169625216`*^9, 3.82868871879954*^9}, 
   3.837423323092683*^9, {3.8374471631829567`*^9, 3.837447166189891*^9}, 
   3.837482865647195*^9, {3.83748650590446*^9, 3.837486515674389*^9}, {
   3.8374865601047926`*^9, 3.8374865698484826`*^9}, {3.837573800224904*^9, 
   3.837573827721392*^9}, {3.8382948555756283`*^9, 3.8382948875230775`*^9}, {
   3.8392405080734577`*^9, 3.839240509496673*^9}, {3.845908474521624*^9, 
   3.845908486131469*^9}, {3.8460780854049487`*^9, 3.8460780863893166`*^9}, {
   3.8468449093043537`*^9, 3.846844911120497*^9}, 3.846845057328478*^9, {
   3.8468450886410856`*^9, 3.846845088896404*^9}, {3.8468451740330434`*^9, 
   3.8468451944241047`*^9}, {3.847633582605837*^9, 3.847633582957895*^9}, 
   3.8521991480171003`*^9, {3.8542845528223853`*^9, 3.854284566766261*^9}, {
   3.8546067085403414`*^9, 3.854606718740966*^9}, 3.855684893220052*^9, {
   3.88831414352378*^9, 3.8883141487731967`*^9}, {3.8889239447295322`*^9, 
   3.8889239518936615`*^9}, {3.889165761976347*^9, 3.8891657724817114`*^9}, {
   3.889898236868268*^9, 3.8898983075866747`*^9}, 3.889981877139629*^9, {
   3.8901318183226905`*^9, 3.8901318584877768`*^9}, {3.8901319074468603`*^9, 
   3.890131912198653*^9}, {3.890132095418976*^9, 3.8901321015214944`*^9}, 
   3.8901983781346855`*^9, {3.8902093468712406`*^9, 3.89020937629113*^9}, {
   3.8903842578656683`*^9, 3.8903842592897663`*^9}, {3.8907148424415026`*^9, 
   3.890714849790765*^9}, {3.890720681833416*^9, 3.8907206948838787`*^9}, {
   3.8928284198180013`*^9, 3.8928284202993*^9}, 3.892918082467703*^9, {
   3.894826375532895*^9, 3.894826378457651*^9}, {3.896368873022723*^9, 
   3.89636890499323*^9}, {3.896368974004279*^9, 3.8963689769333963`*^9}, {
   3.896437869641526*^9, 3.8964378700893507`*^9}, {3.8964393688238535`*^9, 
   3.8964393869032793`*^9}, {3.9275456820992036`*^9, 3.927545697369994*^9}, {
   3.9277839290230837`*^9, 3.9277839528542614`*^9}, {3.9306649367154455`*^9, 
   3.930664936831771*^9}, {3.9306761030072565`*^9, 
   3.9306761099815836`*^9}},ExpressionUUID->"ab188b0e-0b8c-4d83-8dbe-\
6e47cf17a532"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Images <<", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8474400491164675`*^9, 3.8474400514841356`*^9}, {3.8905086724664745`*^9, 
  3.890508675362257*^9}},ExpressionUUID->"80fd0985-c1c7-4fcd-9f0d-\
048ce9507304"],

Cell["\<\
Set the raw image folder:

imageFolder  -- main folder with all experiments
subFolder -- experiment folder (all runs), i.e. \[OpenCurlyDoubleQuote]5p_ \
4ul-min\[CloseCurlyDoubleQuote]

avoid extra pathname separators at the end of path strings\
\>", "Abstract",
 CellChangeTimes->{{3.888922906196766*^9, 3.8889229194346066`*^9}, {
  3.894804961323394*^9, 3.894804965269334*^9}, {3.930291325113571*^9, 
  3.9302913434852905`*^9}, {3.9306338576574726`*^9, 3.930633949857169*^9}, {
  3.9306656795801725`*^9, 3.9306656904278593`*^9}, {3.930673488966628*^9, 
  3.9306735114305243`*^9}},
 FontSize->16,ExpressionUUID->"62616898-1dc0-4674-bcc3-c99a4164e76f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pixelSizeMicroMeters", "=", "0.064"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"frameDurationMiliSeconds", "=", "50"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"frameRate", "=", 
     RowBox[{"1000", "/", "frameDurationMiliSeconds"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "imageFolder", ":=", 
    "\"\<D:\\\\[BIG DATA]\\\\ACTIVE - Data From Experiments\\\\MMML \
Data\\\\OOC Particle Flow\\\\[RAKSTAM]\>\""}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subFolder", ":=", "\"\<5p_4ul-min\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fileFolder", "=", 
     RowBox[{"SetDirectory", "[", 
      RowBox[{"imageFolder", "<>", "$PathnameSeparator", "<>", "subFolder"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"StringSplit", "[", 
           RowBox[{"#", ",", "\"\<.\>\""}], "]"}]}], "&"}], "@", "#"}], "&"}],
       "/@", 
      RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FileNames", "[", "\"\<*.tif\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ToExpression", "@", 
          RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], 
       "\[IndentingNewLine]", "]"}]}], "//", "DeleteDuplicates"}], "//", 
    "Sort"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8223706440166283`*^9, 3.822370655408784*^9}, {
   3.828688415466848*^9, 3.82868842302295*^9}, {3.8374366106307073`*^9, 
   3.837436612730121*^9}, {3.8374366659407735`*^9, 3.837436692066312*^9}, {
   3.8381903902811985`*^9, 3.83819039139227*^9}, {3.8381904680399017`*^9, 
   3.8381904695363336`*^9}, 3.838216530611554*^9, {3.8382191179383373`*^9, 
   3.8382191248648205`*^9}, {3.8382729728363075`*^9, 3.838272996674044*^9}, {
   3.8382863609276934`*^9, 3.8382863610304193`*^9}, {3.838305050105472*^9, 
   3.8383050674773693`*^9}, 3.8383531801353483`*^9, 3.8383552870779576`*^9, 
   3.838355950741046*^9, {3.8383583080979815`*^9, 3.838358320838064*^9}, 
   3.838358642262561*^9, 3.83835938412653*^9, {3.8383596741132855`*^9, 
   3.838359675237794*^9}, 3.8383672241736517`*^9, 3.8383677158146973`*^9, 
   3.8383782172319813`*^9, 3.8383812717115183`*^9, 3.8383919404134965`*^9, {
   3.8383951404896803`*^9, 3.838395141945258*^9}, 3.8383957508263054`*^9, 
   3.8383962092769995`*^9, 3.838440178597614*^9, {3.8384603062397842`*^9, 
   3.83846030632755*^9}, 3.8384874747868905`*^9, 3.8384886340622716`*^9, 
   3.8384898184326525`*^9, 3.8387144349807224`*^9, 3.838718387768408*^9, 
   3.838783672135442*^9, 3.8387855431967335`*^9, 3.8388052155423717`*^9, 
   3.8388052707430196`*^9, 3.8388138451768236`*^9, 3.8388182456485386`*^9, 
   3.839148895384262*^9, 3.8391507672002506`*^9, {3.8392272156353474`*^9, 
   3.8392272162187853`*^9}, 3.8392286941850123`*^9, 3.8392361561605406`*^9, 
   3.839237054370471*^9, 3.8392376434789*^9, 3.839239551639701*^9, {
   3.8392405156909723`*^9, 3.8392405166323752`*^9}, 3.8426915720122404`*^9, 
   3.8426995743483825`*^9, 3.842701441707861*^9, {3.842955349114176*^9, 
   3.842955352410673*^9}, {3.842965903750918*^9, 3.8429659307674704`*^9}, {
   3.8429674715058975`*^9, 3.8429674715916667`*^9}, 3.8429683448606544`*^9, 
   3.843012375014877*^9, 3.8430132360946603`*^9, 3.843014548711771*^9, {
   3.84303679316053*^9, 3.8430368204441023`*^9}, 3.8430372772194633`*^9, 
   3.84303914834064*^9, 3.843041855422675*^9, 3.8430425183085155`*^9, 
   3.8430441409883466`*^9, 3.8430458153123665`*^9, 3.843046434447945*^9, 
   3.8432706623841705`*^9, 3.8458140268217945`*^9, 3.8458142420373936`*^9, {
   3.845814453698887*^9, 3.845814454283103*^9}, 3.8458147898582354`*^9, 
   3.845814918747543*^9, 3.845952924411313*^9, 3.845963521992029*^9, 
   3.8459655352923117`*^9, 3.845976038814541*^9, 3.845994196093089*^9, {
   3.8460477500394373`*^9, 3.8460477510575123`*^9}, 3.8460520665603027`*^9, 
   3.8462449041652713`*^9, {3.8471795139218264`*^9, 3.8471795148409224`*^9}, 
   3.8473576654171953`*^9, 3.8473594101762486`*^9, {3.8473615178251505`*^9, 
   3.847361518712777*^9}, 3.852223868441091*^9, {3.8522241246689367`*^9, 
   3.852224127354022*^9}, 3.854283893172999*^9, 3.854283974123249*^9, {
   3.854284028747675*^9, 3.8542840361945086`*^9}, {3.8546066921224084`*^9, 
   3.8546067913507395`*^9}, 3.860576169449164*^9, 3.860576255705443*^9, 
   3.8605763894079404`*^9, {3.86057685706324*^9, 3.8605768843226213`*^9}, 
   3.8606702712773504`*^9, {3.86073503842074*^9, 3.860735065978959*^9}, 
   3.860920334990741*^9, 3.861468008499719*^9, {3.861549367591876*^9, 
   3.861549369023287*^9}, 3.8615494706474485`*^9, 3.861551661877142*^9, 
   3.8615517295575304`*^9, {3.8615519494698534`*^9, 3.86155195636662*^9}, 
   3.8616140465087533`*^9, 3.861616996296524*^9, 3.8616170617156515`*^9, 
   3.8616172704118323`*^9, 3.861650609512191*^9, 3.8616997318111105`*^9, 
   3.8616998512851644`*^9, 3.861699942200835*^9, 3.8617822044287*^9, 
   3.8617822627454386`*^9, {3.8617920886905766`*^9, 3.8617921010953455`*^9}, {
   3.8617989203499813`*^9, 3.861798928798402*^9}, {3.861799913340885*^9, 
   3.861799927804253*^9}, {3.861800345316432*^9, 3.8618003525178585`*^9}, {
   3.86181483099113*^9, 3.8618148443292217`*^9}, 3.8618688336974387`*^9, {
   3.862045267973294*^9, 3.8620452740683985`*^9}, 3.862478514969168*^9, 
   3.8625042707295294`*^9, 3.8625043084647055`*^9, {3.8626568001531677`*^9, 
   3.8626568092538567`*^9}, {3.8692176956431427`*^9, 3.8692177152949505`*^9}, 
   3.8692365233272886`*^9, 3.8692366194637704`*^9, {3.885294833725152*^9, 
   3.885294841320782*^9}, {3.8854052365747857`*^9, 3.8854052412599115`*^9}, {
   3.8854055922472963`*^9, 3.8854055938157024`*^9}, 3.8854079673340645`*^9, {
   3.8883961500345616`*^9, 3.8883962011787496`*^9}, {3.888396250859366*^9, 
   3.8883963143530865`*^9}, 3.888396982601926*^9, {3.8883970349050303`*^9, 
   3.8883970444570365`*^9}, 3.8883971606172276`*^9, {3.888397212240456*^9, 
   3.8883972183127766`*^9}, {3.8883972487367496`*^9, 
   3.8883972513682947`*^9}, {3.8883973366649513`*^9, 
   3.8883973372631006`*^9}, {3.8889140791658525`*^9, 
   3.8889140800045233`*^9}, {3.88892403175506*^9, 3.8889240614087667`*^9}, {
   3.8890246062319145`*^9, 3.889024620080434*^9}, 3.8898983423873997`*^9, 
   3.890209967495713*^9, {3.8902121628342886`*^9, 3.890212168297205*^9}, 
   3.890212277516303*^9, 3.8908333148567657`*^9, 3.8927990393754654`*^9, 
   3.892811183199755*^9, 3.8929093283190026`*^9, 3.892912004719715*^9, 
   3.8929128126642265`*^9, 3.893483408726311*^9, {3.893483851388729*^9, 
   3.893483892130946*^9}, 3.893595020789238*^9, 3.894132644798708*^9, 
   3.8941331271439743`*^9, 3.894618934796352*^9, 3.894621747010389*^9, 
   3.894699242941082*^9, 3.8947130527156296`*^9, 3.894713678325944*^9, 
   3.8947202441518464`*^9, {3.8963488777532024`*^9, 3.8963489077113276`*^9}, {
   3.8969467868259034`*^9, 3.8969468588509398`*^9}, {3.8982635394601865`*^9, 
   3.898263562949216*^9}, {3.898759769427726*^9, 3.8987598019567976`*^9}, 
   3.8987599933960953`*^9, 3.8987600433399396`*^9, 3.8987679377878556`*^9, 
   3.8987679682261624`*^9, {3.898823609208624*^9, 3.898823614940817*^9}, {
   3.899798135288001*^9, 3.899798141262788*^9}, 3.899798205324564*^9, 
   3.899798260718631*^9, 3.8998653379291897`*^9, 3.8998709288580785`*^9, 
   3.899871219183766*^9, {3.899908295322106*^9, 3.899908302384104*^9}, {
   3.8999098091507807`*^9, 3.8999098173315563`*^9}, 3.8999099102888536`*^9, {
   3.900088828860634*^9, 3.9000888296600113`*^9}, {3.9003115337660246`*^9, 
   3.9003115416709337`*^9}, 3.9003116203091607`*^9, {3.90032528488822*^9, 
   3.900325291613229*^9}, 3.9003269408393583`*^9, 3.9004144707109976`*^9, {
   3.9004145032242146`*^9, 3.9004145235828266`*^9}, 3.900427538647484*^9, {
   3.9004282541571226`*^9, 3.900428254406458*^9}, 3.9004283906832666`*^9, 
   3.9004349807512827`*^9, 3.9005986066269503`*^9, {3.9006153527759433`*^9, 
   3.900615352837524*^9}, {3.900665423386632*^9, 3.90066542342747*^9}, 
   3.9006694508767757`*^9, {3.900670807774931*^9, 3.9006708089656396`*^9}, 
   3.903154027967885*^9, {3.9031540595418916`*^9, 3.903154062553068*^9}, 
   3.9031997278405995`*^9, {3.9032031343679795`*^9, 3.9032031406762657`*^9}, 
   3.9033464216572227`*^9, 3.903363851391332*^9, 3.903366055584881*^9, 
   3.903366761687172*^9, {3.9033671099688177`*^9, 3.9033671150701137`*^9}, {
   3.9056720071588945`*^9, 3.9056720814829807`*^9}, {3.905856433286765*^9, 
   3.905856468727187*^9}, {3.905856624007283*^9, 3.9058566296625075`*^9}, {
   3.9059689649052525`*^9, 3.9059689716978426`*^9}, {3.90596903634801*^9, 
   3.9059690488568416`*^9}, {3.90602145687527*^9, 3.9060214891778955`*^9}, 
   3.9060216308085995`*^9, {3.906023276821838*^9, 3.9060232769484444`*^9}, 
   3.9060241079480658`*^9, 3.9060241519174557`*^9, 3.906050764330043*^9, 
   3.9060513911369925`*^9, {3.907141788412467*^9, 3.9071419759274282`*^9}, {
   3.907142081166868*^9, 3.9071420864521227`*^9}, {3.915102345121501*^9, 
   3.9151023588270226`*^9}, 3.915104346300583*^9, {3.927545636865239*^9, 
   3.927545637376933*^9}, {3.9275459381695657`*^9, 3.927545960732724*^9}, {
   3.9275465086975694`*^9, 3.9275465321388206`*^9}, 3.9276096154481616`*^9, 
   3.9276112731368923`*^9, {3.927641534268278*^9, 3.9276415361958666`*^9}, 
   3.9277415682010965`*^9, 3.927745305800991*^9, {3.927783960582271*^9, 
   3.927783969197937*^9}, 3.9277953457058916`*^9, {3.9278160223914146`*^9, 
   3.927816037919938*^9}, {3.9278228629136915`*^9, 3.9278228845309696`*^9}, {
   3.927822937980733*^9, 3.927822941140068*^9}, {3.927823048358512*^9, 
   3.9278231192442265`*^9}, {3.927823161987673*^9, 3.9278232067871428`*^9}, 
   3.9278748494502316`*^9, {3.9278756615531425`*^9, 3.927875680976345*^9}, {
   3.927875944569384*^9, 3.927875959818471*^9}, {3.9278775229590087`*^9, 
   3.927877548376278*^9}, 3.9278776501199512`*^9, 3.9278854861231985`*^9, {
   3.9278855524847546`*^9, 3.927885595082094*^9}, {3.9278879502360716`*^9, 
   3.9278880042480373`*^9}, {3.9278881002356095`*^9, 3.9278881046016884`*^9}, 
   3.9278916836467543`*^9, 3.9303844747478666`*^9, 3.9303903831810036`*^9, {
   3.9303907370254583`*^9, 3.930390738452739*^9}, 3.930391366767397*^9, 
   3.9303921009406652`*^9, {3.930393515060916*^9, 3.930393515148241*^9}, 
   3.930394045541094*^9, 3.930394398421557*^9, {3.9303948587393827`*^9, 
   3.930394858852372*^9}, {3.930395894709757*^9, 3.9303958954000397`*^9}, {
   3.930398010652035*^9, 3.9303980110804234`*^9}, {3.9303993642565236`*^9, 
   3.9303993647000465`*^9}, {3.9303999597314544`*^9, 3.93039996011187*^9}, {
   3.930400432730714*^9, 3.9304004327888327`*^9}, {3.9304010378355603`*^9, 
   3.930401038793381*^9}, {3.9304014775605288`*^9, 3.9304014776383824`*^9}, {
   3.930402467247386*^9, 3.9304024677004633`*^9}, {3.930402735590598*^9, 
   3.9304027358212023`*^9}, 3.930403330229048*^9, 3.9304036370538826`*^9, 
   3.9304044661643114`*^9, 3.930405023403927*^9, {3.930405255004711*^9, 
   3.930405255130082*^9}, {3.930405602526223*^9, 3.93040560619565*^9}, {
   3.930405853291687*^9, 3.93040585457113*^9}, {3.930406208889925*^9, 
   3.930406223842516*^9}, 3.9305840791975355`*^9, {3.9305841437801447`*^9, 
   3.930584148939907*^9}, {3.930584200846011*^9, 3.9305842324406223`*^9}, {
   3.930584277571431*^9, 3.9305842811920853`*^9}, {3.930584313275502*^9, 
   3.9305843392748947`*^9}, 3.9305843866761665`*^9, {3.9305872010991783`*^9, 
   3.9305872025134697`*^9}, 3.930587892994947*^9, 3.9305899570964947`*^9, {
   3.930640095873516*^9, 3.9306400975627365`*^9}, {3.9306648624936314`*^9, 
   3.9306648703734255`*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"f2df995a-561c-4dcc-83ed-057b4b0b65b1"],

Cell["\<\
runID -- select the imaging run (focus plane) for processing

Example:
runID=4;\
\>", "Abstract",
 CellChangeTimes->{{3.888922906196766*^9, 3.8889229194346066`*^9}, {
  3.894804961323394*^9, 3.894804965269334*^9}, {3.930291325113571*^9, 
  3.9302913434852905`*^9}, {3.9306338576574726`*^9, 3.930634049619918*^9}, {
  3.9306340896974316`*^9, 3.9306340918488035`*^9}},
 FontSize->16,ExpressionUUID->"aeba573c-23b2-4025-851e-0f311304801d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"runID", "=", "8"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"runIdentifier", "=", 
    RowBox[{"\"\<run\>\"", "<>", 
     RowBox[{"ToString", "@", "runID"}], "<>", "\"\<.\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{"StringContainsQ", "@", "runIdentifier"}]}], "]"}], "&"}], 
     "@", 
     RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FileNames", "[", "\"\<*.tif\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ToExpression", "@", 
         RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]",
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"files", "=", 
    RowBox[{"Sort", "@", 
     RowBox[{"FileNames", "[", "\"\<*.tiff\>\"", "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"files", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "25"}], "]"}], "]"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"output", "=", 
   RowBox[{
   "mainOutputFolder", "<>", "$PathnameSeparator", "<>", "subFolder", "<>", 
    "$PathnameSeparator", "<>", 
    RowBox[{"StringDelete", "[", 
     RowBox[{"runIdentifier", ",", "\"\<.\>\""}], "]"}], "<>", 
    "$PathnameSeparator"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "output"}], ";"}], "//", "Quiet"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataCSVfolder", "=", 
   RowBox[{"output", "<>", "\"\<CSV\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "dataCSVfolder"}], ";"}], "//", "Quiet"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataCompressedfolder", "=", 
   RowBox[{"output", "<>", "\"\<Compressed Data\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateDirectory", "@", "dataCompressedfolder"}], ";"}], "//", 
  "Quiet"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8223706440166283`*^9, 3.822370655408784*^9}, {
   3.828688415466848*^9, 3.82868842302295*^9}, {3.8374366106307073`*^9, 
   3.837436612730121*^9}, {3.8374366659407735`*^9, 3.837436692066312*^9}, {
   3.8381903902811985`*^9, 3.83819039139227*^9}, {3.8381904680399017`*^9, 
   3.8381904695363336`*^9}, 3.838216530611554*^9, {3.8382191179383373`*^9, 
   3.8382191248648205`*^9}, {3.8382729728363075`*^9, 3.838272996674044*^9}, {
   3.8382863609276934`*^9, 3.8382863610304193`*^9}, {3.838305050105472*^9, 
   3.8383050674773693`*^9}, 3.8383531801353483`*^9, 3.8383552870779576`*^9, 
   3.838355950741046*^9, {3.8383583080979815`*^9, 3.838358320838064*^9}, 
   3.838358642262561*^9, 3.83835938412653*^9, {3.8383596741132855`*^9, 
   3.838359675237794*^9}, 3.8383672241736517`*^9, 3.8383677158146973`*^9, 
   3.8383782172319813`*^9, 3.8383812717115183`*^9, 3.8383919404134965`*^9, {
   3.8383951404896803`*^9, 3.838395141945258*^9}, 3.8383957508263054`*^9, 
   3.8383962092769995`*^9, 3.838440178597614*^9, {3.8384603062397842`*^9, 
   3.83846030632755*^9}, 3.8384874747868905`*^9, 3.8384886340622716`*^9, 
   3.8384898184326525`*^9, 3.8387144349807224`*^9, 3.838718387768408*^9, 
   3.838783672135442*^9, 3.8387855431967335`*^9, 3.8388052155423717`*^9, 
   3.8388052707430196`*^9, 3.8388138451768236`*^9, 3.8388182456485386`*^9, 
   3.839148895384262*^9, 3.8391507672002506`*^9, {3.8392272156353474`*^9, 
   3.8392272162187853`*^9}, 3.8392286941850123`*^9, 3.8392361561605406`*^9, 
   3.839237054370471*^9, 3.8392376434789*^9, 3.839239551639701*^9, {
   3.8392405156909723`*^9, 3.8392405166323752`*^9}, 3.8426915720122404`*^9, 
   3.8426995743483825`*^9, 3.842701441707861*^9, {3.842955349114176*^9, 
   3.842955352410673*^9}, {3.842965903750918*^9, 3.8429659307674704`*^9}, {
   3.8429674715058975`*^9, 3.8429674715916667`*^9}, 3.8429683448606544`*^9, 
   3.843012375014877*^9, 3.8430132360946603`*^9, 3.843014548711771*^9, {
   3.84303679316053*^9, 3.8430368204441023`*^9}, 3.8430372772194633`*^9, 
   3.84303914834064*^9, 3.843041855422675*^9, 3.8430425183085155`*^9, 
   3.8430441409883466`*^9, 3.8430458153123665`*^9, 3.843046434447945*^9, 
   3.8432706623841705`*^9, 3.8458140268217945`*^9, 3.8458142420373936`*^9, {
   3.845814453698887*^9, 3.845814454283103*^9}, 3.8458147898582354`*^9, 
   3.845814918747543*^9, 3.845952924411313*^9, 3.845963521992029*^9, 
   3.8459655352923117`*^9, 3.845976038814541*^9, 3.845994196093089*^9, {
   3.8460477500394373`*^9, 3.8460477510575123`*^9}, 3.8460520665603027`*^9, 
   3.8462449041652713`*^9, {3.8471795139218264`*^9, 3.8471795148409224`*^9}, 
   3.8473576654171953`*^9, 3.8473594101762486`*^9, {3.8473615178251505`*^9, 
   3.847361518712777*^9}, 3.852223868441091*^9, {3.8522241246689367`*^9, 
   3.852224127354022*^9}, 3.854283893172999*^9, 3.854283974123249*^9, {
   3.854284028747675*^9, 3.8542840361945086`*^9}, {3.8546066921224084`*^9, 
   3.8546067913507395`*^9}, 3.860576169449164*^9, 3.860576255705443*^9, 
   3.8605763894079404`*^9, {3.86057685706324*^9, 3.8605768843226213`*^9}, 
   3.8606702712773504`*^9, {3.86073503842074*^9, 3.860735065978959*^9}, 
   3.860920334990741*^9, 3.861468008499719*^9, {3.861549367591876*^9, 
   3.861549369023287*^9}, 3.8615494706474485`*^9, 3.861551661877142*^9, 
   3.8615517295575304`*^9, {3.8615519494698534`*^9, 3.86155195636662*^9}, 
   3.8616140465087533`*^9, 3.861616996296524*^9, 3.8616170617156515`*^9, 
   3.8616172704118323`*^9, 3.861650609512191*^9, 3.8616997318111105`*^9, 
   3.8616998512851644`*^9, 3.861699942200835*^9, 3.8617822044287*^9, 
   3.8617822627454386`*^9, {3.8617920886905766`*^9, 3.8617921010953455`*^9}, {
   3.8617989203499813`*^9, 3.861798928798402*^9}, {3.861799913340885*^9, 
   3.861799927804253*^9}, {3.861800345316432*^9, 3.8618003525178585`*^9}, {
   3.86181483099113*^9, 3.8618148443292217`*^9}, 3.8618688336974387`*^9, {
   3.862045267973294*^9, 3.8620452740683985`*^9}, 3.862478514969168*^9, 
   3.8625042707295294`*^9, 3.8625043084647055`*^9, {3.8626568001531677`*^9, 
   3.8626568092538567`*^9}, {3.8692176956431427`*^9, 3.8692177152949505`*^9}, 
   3.8692365233272886`*^9, 3.8692366194637704`*^9, {3.885294833725152*^9, 
   3.885294841320782*^9}, {3.8854052365747857`*^9, 3.8854052412599115`*^9}, {
   3.8854055922472963`*^9, 3.8854055938157024`*^9}, 3.8854079673340645`*^9, {
   3.8883961500345616`*^9, 3.8883962011787496`*^9}, {3.888396250859366*^9, 
   3.8883963143530865`*^9}, 3.888396982601926*^9, {3.8883970349050303`*^9, 
   3.8883970444570365`*^9}, 3.8883971606172276`*^9, {3.888397212240456*^9, 
   3.8883972183127766`*^9}, {3.8883972487367496`*^9, 
   3.8883972513682947`*^9}, {3.8883973366649513`*^9, 
   3.8883973372631006`*^9}, {3.8889140791658525`*^9, 
   3.8889140800045233`*^9}, {3.88892403175506*^9, 3.8889240614087667`*^9}, {
   3.8890246062319145`*^9, 3.889024620080434*^9}, 3.8898983423873997`*^9, 
   3.890209967495713*^9, {3.8902121628342886`*^9, 3.890212168297205*^9}, 
   3.890212277516303*^9, 3.8908333148567657`*^9, 3.8927990393754654`*^9, 
   3.892811183199755*^9, 3.8929093283190026`*^9, 3.892912004719715*^9, 
   3.8929128126642265`*^9, 3.893483408726311*^9, {3.893483851388729*^9, 
   3.893483892130946*^9}, 3.893595020789238*^9, 3.894132644798708*^9, 
   3.8941331271439743`*^9, 3.894618934796352*^9, 3.894621747010389*^9, 
   3.894699242941082*^9, 3.8947130527156296`*^9, 3.894713678325944*^9, 
   3.8947202441518464`*^9, {3.8963488777532024`*^9, 3.8963489077113276`*^9}, {
   3.8969467868259034`*^9, 3.8969468588509398`*^9}, {3.8982635394601865`*^9, 
   3.898263562949216*^9}, {3.898759769427726*^9, 3.8987598019567976`*^9}, 
   3.8987599933960953`*^9, 3.8987600433399396`*^9, 3.8987679377878556`*^9, 
   3.8987679682261624`*^9, {3.898823609208624*^9, 3.898823614940817*^9}, {
   3.899798135288001*^9, 3.899798141262788*^9}, 3.899798205324564*^9, 
   3.899798260718631*^9, 3.8998653379291897`*^9, 3.8998709288580785`*^9, 
   3.899871219183766*^9, {3.899908295322106*^9, 3.899908302384104*^9}, {
   3.8999098091507807`*^9, 3.8999098173315563`*^9}, 3.8999099102888536`*^9, {
   3.900088828860634*^9, 3.9000888296600113`*^9}, {3.9003115337660246`*^9, 
   3.9003115416709337`*^9}, 3.9003116203091607`*^9, {3.90032528488822*^9, 
   3.900325291613229*^9}, 3.9003269408393583`*^9, 3.9004144707109976`*^9, {
   3.9004145032242146`*^9, 3.9004145235828266`*^9}, 3.900427538647484*^9, {
   3.9004282541571226`*^9, 3.900428254406458*^9}, 3.9004283906832666`*^9, 
   3.9004349807512827`*^9, 3.9005986066269503`*^9, {3.9006153527759433`*^9, 
   3.900615352837524*^9}, {3.900665423386632*^9, 3.90066542342747*^9}, 
   3.9006694508767757`*^9, {3.900670807774931*^9, 3.9006708089656396`*^9}, 
   3.903154027967885*^9, {3.9031540595418916`*^9, 3.903154062553068*^9}, 
   3.9031997278405995`*^9, {3.9032031343679795`*^9, 3.9032031406762657`*^9}, 
   3.9033464216572227`*^9, 3.903363851391332*^9, 3.903366055584881*^9, 
   3.903366761687172*^9, {3.9033671099688177`*^9, 3.9033671150701137`*^9}, {
   3.9056720071588945`*^9, 3.9056720814829807`*^9}, {3.905856433286765*^9, 
   3.905856468727187*^9}, {3.905856624007283*^9, 3.9058566296625075`*^9}, {
   3.9059689649052525`*^9, 3.9059689716978426`*^9}, {3.90596903634801*^9, 
   3.9059690488568416`*^9}, {3.90602145687527*^9, 3.9060214891778955`*^9}, 
   3.9060216308085995`*^9, {3.906023276821838*^9, 3.9060232769484444`*^9}, 
   3.9060241079480658`*^9, 3.9060241519174557`*^9, 3.906050764330043*^9, 
   3.9060513911369925`*^9, {3.907141788412467*^9, 3.9071419759274282`*^9}, {
   3.907142081166868*^9, 3.9071420864521227`*^9}, {3.915102345121501*^9, 
   3.9151023588270226`*^9}, 3.915104346300583*^9, {3.927545636865239*^9, 
   3.927545637376933*^9}, {3.9275459381695657`*^9, 3.927545960732724*^9}, {
   3.9275465086975694`*^9, 3.9275465321388206`*^9}, 3.9276096154481616`*^9, 
   3.9276112731368923`*^9, {3.927641534268278*^9, 3.9276415361958666`*^9}, 
   3.9277415682010965`*^9, 3.927745305800991*^9, {3.927783960582271*^9, 
   3.927783969197937*^9}, 3.9277953457058916`*^9, {3.9278160223914146`*^9, 
   3.927816037919938*^9}, {3.9278228629136915`*^9, 3.9278228845309696`*^9}, {
   3.927822937980733*^9, 3.927822941140068*^9}, {3.927823048358512*^9, 
   3.9278231192442265`*^9}, {3.927823161987673*^9, 3.9278232067871428`*^9}, 
   3.9278748494502316`*^9, {3.9278756615531425`*^9, 3.927875680976345*^9}, {
   3.927875944569384*^9, 3.927875959818471*^9}, {3.9278775229590087`*^9, 
   3.927877548376278*^9}, 3.9278776501199512`*^9, 3.9278854861231985`*^9, {
   3.9278855524847546`*^9, 3.927885595082094*^9}, {3.9278879502360716`*^9, 
   3.9278880042480373`*^9}, {3.9278881002356095`*^9, 3.9278881046016884`*^9}, 
   3.9278916836467543`*^9, 3.9303844747478666`*^9, 3.9303903831810036`*^9, {
   3.9303907370254583`*^9, 3.930390738452739*^9}, 3.930391366767397*^9, 
   3.9303921009406652`*^9, {3.930393515060916*^9, 3.930393515148241*^9}, 
   3.930394045541094*^9, 3.930394398421557*^9, {3.9303948587393827`*^9, 
   3.930394858852372*^9}, {3.930395894709757*^9, 3.9303958954000397`*^9}, {
   3.930398010652035*^9, 3.9303980110804234`*^9}, {3.9303993642565236`*^9, 
   3.9303993647000465`*^9}, {3.9303999597314544`*^9, 3.93039996011187*^9}, {
   3.930400432730714*^9, 3.9304004327888327`*^9}, {3.9304010378355603`*^9, 
   3.930401038793381*^9}, {3.9304014775605288`*^9, 3.9304014776383824`*^9}, {
   3.930402467247386*^9, 3.9304024677004633`*^9}, {3.930402735590598*^9, 
   3.9304027358212023`*^9}, 3.930403330229048*^9, 3.9304036370538826`*^9, 
   3.9304044661643114`*^9, 3.930405023403927*^9, {3.930405255004711*^9, 
   3.930405255130082*^9}, {3.930405602526223*^9, 3.93040560619565*^9}, {
   3.930405853291687*^9, 3.93040585457113*^9}, 3.930406208889925*^9, {
   3.9304103591392684`*^9, 3.9304103613116217`*^9}, {3.9304111242553344`*^9, 
   3.9304111243761992`*^9}, {3.9304113609208937`*^9, 
   3.9304113617001877`*^9}, {3.9304134739399977`*^9, 
   3.9304134740603933`*^9}, {3.930413895027439*^9, 3.930413895537508*^9}, 
   3.9305406132745066`*^9, {3.930541127443618*^9, 3.930541127609395*^9}, {
   3.9305421095690866`*^9, 3.930542109615961*^9}, 3.930555157762884*^9, 
   3.930555432474392*^9, 3.9305559386641884`*^9, 3.9305583793302193`*^9, 
   3.9305624337467556`*^9, {3.9305655308108635`*^9, 3.9305655311280746`*^9}, {
   3.930566739388285*^9, 3.9305667401472006`*^9}, {3.9305675028034725`*^9, 
   3.930567507063606*^9}, {3.930568172927889*^9, 3.9305681734395127`*^9}, {
   3.9305684530808873`*^9, 3.9305684536604495`*^9}, 3.9305687917182107`*^9, 
   3.930569072446147*^9, 3.930576640073378*^9, 3.9305769411697187`*^9, {
   3.930577766505858*^9, 3.9305777665681963`*^9}, 3.9305789634084682`*^9, 
   3.930579501760183*^9, 3.930579760088544*^9, 3.930580699863716*^9, {
   3.930581033504656*^9, 3.9305810335975623`*^9}, 3.9305831182292337`*^9, {
   3.930584141208107*^9, 3.9305841648451457`*^9}, 3.9305844151561165`*^9, {
   3.9305872092585597`*^9, 3.930587209297534*^9}, {3.9305879095061836`*^9, 
   3.93058791308125*^9}, 3.9305888314573183`*^9, {3.9305891156251087`*^9, 
   3.9305891242487245`*^9}, 3.930589941593949*^9, 3.930590342120734*^9, {
   3.930590572383551*^9, 3.930590574135273*^9}, {3.930590845848056*^9, 
   3.9305908501183753`*^9}, 3.9305913843920927`*^9, {3.930591625656907*^9, 
   3.930591628206422*^9}, 3.9306331839484816`*^9, {3.930664812010123*^9, 
   3.9306648120804634`*^9}, {3.9306648878878083`*^9, 
   3.9306649206693163`*^9}, {3.9306649577005377`*^9, 3.9306649592471046`*^9}, 
   3.9306685357690773`*^9, 
   3.9307367154936686`*^9},ExpressionUUID->"29f4f347-5bc7-411b-a743-\
fef79f040a60"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"images", "=", 
      RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"fileFolder", "<>", "$PathnameSeparator", "<>", "#"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", "files"}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"images", "=", 
   RowBox[{"Last", "/@", "images"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"#", "@", 
     RowBox[{"First", "@", "images"}]}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"ImageDimensions", ",", "ImageType"}], "}"}]}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.82237034851377*^9, 3.822370354429882*^9}, 
   3.822370406705285*^9, {3.8223707318084*^9, 3.8223707386015005`*^9}, {
   3.8223708729527082`*^9, 3.822370904441451*^9}, {3.8459085060339146`*^9, 
   3.8459085143374596`*^9}, 3.8609203411662297`*^9, {3.88537816042834*^9, 
   3.8853782515299673`*^9}, {3.889024629776803*^9, 3.8890246300244803`*^9}, {
   3.889898347437231*^9, 3.889898347625966*^9}, {3.8900450734216557`*^9, 
   3.890045084298572*^9}, {3.8932634378919077`*^9, 3.893263488648225*^9}, 
   3.9056720898331113`*^9, 3.905856474029355*^9, {3.9278232193628144`*^9, 
   3.927823224147746*^9}, 3.9278759153945913`*^9, 3.9278881551913605`*^9, 
   3.927891696975605*^9},
 CellLabel->
  "In[253]:=",ExpressionUUID->"a4efabc0-6431-4664-b053-de608be82619"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function Definitions", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 
  3.8468307830344753`*^9}},ExpressionUUID->"a6c1a855-d2ce-4ce7-8e77-\
3002edfcfd56"],

Cell["ALWAYS EVALUATE THESE CELLS", "Abstract",
 CellChangeTimes->{{3.888922906196766*^9, 3.8889229194346066`*^9}, {
  3.894804961323394*^9, 3.894804965269334*^9}, {3.930291325113571*^9, 
  3.9302913434852905`*^9}, {3.93063428562481*^9, 3.930634287473113*^9}},
 FontSize->24,ExpressionUUID->"8a8ace1e-91d8-44d1-814b-518b0d9b29f6"],

Cell[CellGroupData[{

Cell["Image Filtering & Manipulation", "Subsection",
 CellChangeTimes->{{3.8381889592254605`*^9, 3.8381889906103125`*^9}},
 FontSize->24,ExpressionUUID->"0e5b0001-b41e-4467-b3f9-0da9893d8598"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"backgroundBias", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"placeholderBias", "=", 
    RowBox[{"10", "^", 
     RowBox[{"-", "6"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"viewImage", "[", "image_", "]"}], ":=", 
  RowBox[{"Image", "[", 
   RowBox[{"image", ",", 
    RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotateImage", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageRotate", "[", 
      RowBox[{"#", ",", 
       RowBox[{"rotationSwitch", "*", 
        RowBox[{"\[Pi]", "/", "2"}]}]}], "]"}], "&"}], "@", "image"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"meanCorrection", "[", 
    RowBox[{"image_", ",", "meanImage_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"image", "-", "meanImage"}], "//", "ImageAdjust"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"meanCorrectionFlat", "[", 
    RowBox[{"image_", ",", "meanImage_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ImageMultiply", "[", 
     RowBox[{"image", ",", 
      RowBox[{"meanImage", "^", 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}]}], "]"}], "//", "ImageAdjust"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"applySCTMM", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{"#", "-", 
         RowBox[{"ColorNegate", "@", 
          RowBox[{"ColorToneMapping", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", "luminanceCompression", ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Luminance\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}]}]}], "]"}]}], "&"}], "@", 
    "image"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"applyNMM", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "*", "image"}], "-", 
     RowBox[{"nonlocalCorrectionWeight", "*", 
      RowBox[{"NonlocalMeansFilter", "[", "\[IndentingNewLine]", 
       RowBox[{
       "image", ",", "nonlocalCorrectionRadius", ",", "nonlocalNoiseFactor"}],
        "\[IndentingNewLine]", "]"}]}]}], "//", "ImageAdjust"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"preprocessImage", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"BrightnessEqualize", "[", 
      RowBox[{"#", "+", "placeholderBias"}], "]"}], "&"}], "@", 
    RowBox[{"ImageAdjust", "@", 
     RowBox[{"ColorToneMapping", "@", 
      RowBox[{"ImageAdjust", "@", "image"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"preprocessImageInverted", "[", "image_", "]"}], ":=", 
  RowBox[{"ColorNegate", "@", 
   RowBox[{"preprocessImage", "@", 
    RowBox[{"ColorNegate", "@", "image"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"applyCTMinverted", "[", "image_", "]"}], ":=", 
   RowBox[{"ColorNegate", "@", 
    RowBox[{"ColorToneMapping", "@", 
     RowBox[{"ColorNegate", "@", "image"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"globalFiltering", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Nest", "[", "\[IndentingNewLine]", 
              RowBox[{
              "applyCTMinverted", ",", "#", ",", 
               "preprocessPassesSecondary"}], "\[IndentingNewLine]", "]"}], 
             "&"}], "@", 
            RowBox[{"PeronaMalikFilter", "[", "\[IndentingNewLine]", 
             RowBox[{
             "#", ",", "peronaMalikIterations", ",", 
              "peronaMalikConductivity"}], "\[IndentingNewLine]", "]"}]}], 
           "&"}], "@", 
          RowBox[{"applyNMM", "@", 
           RowBox[{"Nest", "[", 
            RowBox[{"ColorToneMapping", ",", "#", ",", "useCTMprimary"}], 
            "]"}]}]}], "&"}], "@", 
        RowBox[{"Nest", "[", "\[IndentingNewLine]", 
         RowBox[{
         "preprocessImageInverted", ",", "#", ",", 
          "preprocessPassesPrimary"}], "\[IndentingNewLine]", "]"}]}], "&"}], 
      "@", 
      RowBox[{"ImageMultiply", "[", 
       RowBox[{
        RowBox[{"ColorNegate", "@", "channelWallMask"}], ",", "#"}], "]"}]}], 
     "&"}], "@", "image"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"globalSegmentation", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"SelectComponents", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"sizeMinimum", "<", "#Count", "<", "sizeMaximum"}], 
            "&"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
        RowBox[{"DeleteBorderComponents", "@", 
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Method", "\[Rule]", "\"\<Entropy\>\""}]}], "]"}]}]}], 
       "&"}], "@", 
      RowBox[{"ImageMultiply", "[", 
       RowBox[{
        RowBox[{"ColorNegate", "@", "channelWallMask"}], ",", "#"}], "]"}]}], 
     "&"}], "@", "image"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getImageDisplacementsMap", "[", "imagePair_", "]"}], ":=", 
   RowBox[{"Image", "@", 
    RowBox[{"Rescale", "@", 
     RowBox[{"First", "@", 
      RowBox[{"ImageDisplacements", "@", "imagePair"}]}]}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getChannelWallMask", "[", "image_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ImageSubtract", "[", 
               RowBox[{"#", ",", 
                RowBox[{"DeleteBorderComponents", "@", "#"}]}], "]"}], "&"}], 
             "@", 
             RowBox[{"Dilation", "[", 
              RowBox[{"#", ",", 
               RowBox[{"DiskMatrix", "@", "dilationScale"}]}], "]"}]}], "&"}],
            "@", 
           RowBox[{"ColorNegate", "@", 
            RowBox[{"Opening", "[", 
             RowBox[{"#", ",", 
              RowBox[{"DiskMatrix", "@", "openingSmoothingScale"}]}], 
             "]"}]}]}], "&"}], "@", 
         RowBox[{"ColorNegate", "@", 
          RowBox[{"Closing", "[", 
           RowBox[{"#", ",", 
            RowBox[{"DiskMatrix", "@", "closingScale"}]}], "]"}]}]}], "&"}], 
       "@", 
       RowBox[{"Binarize", "@", 
        RowBox[{"GaussianFilter", "[", 
         RowBox[{"#", ",", "gaussianScale"}], "]"}]}]}], "&"}], "@", 
     RowBox[{"LocalAdaptiveBinarize", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"applySCTMM", "@", 
        RowBox[{"ColorNegate", "@", "#"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"adaptiveBinarizeScaleFactor", "*", 
          RowBox[{"Median", "@", 
           RowBox[{"ImageDimensions", "@", "#"}]}]}], "//", "N"}], "//", 
        "Round"}]}], "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
   RowBox[{"ImageRotate", "[", 
    RowBox[{"image", ",", 
     RowBox[{"-", "rotationAngle"}]}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8381890059119296`*^9, {3.8381893677521863`*^9, 3.8381893696496534`*^9}, {
   3.838189457199703*^9, 3.838189457584342*^9}, {3.8382126360472965`*^9, 
   3.8382126363285446`*^9}, {3.8382149489599414`*^9, 
   3.8382149492401924`*^9}, {3.838293176831523*^9, 3.8382931784701414`*^9}, {
   3.8391485552078114`*^9, 3.839148556895608*^9}, 3.839148672008988*^9, {
   3.839149255616995*^9, 3.839149259809787*^9}, {3.842955724667177*^9, 
   3.8429558004029775`*^9}, {3.842955841163106*^9, 3.8429558419005594`*^9}, 
   3.84295587762633*^9, {3.843304653089132*^9, 3.8433046561598926`*^9}, {
   3.8433048180942583`*^9, 3.8433048242616744`*^9}, {3.8433055032045217`*^9, 
   3.8433055042237835`*^9}, {3.8434800790645485`*^9, 
   3.8434800798615627`*^9}, {3.8434808011695547`*^9, 3.843480801723075*^9}, {
   3.8458162682218466`*^9, 3.8458162686108065`*^9}, {3.8466704748407636`*^9, 
   3.846670475504183*^9}, {3.8467523367189393`*^9, 3.8467523374546785`*^9}, {
   3.846752387230635*^9, 3.8467523881428027`*^9}, {3.846769318722342*^9, 
   3.8467693208825655`*^9}, {3.8467694299469147`*^9, 3.846769431114791*^9}, {
   3.846829503023484*^9, 3.8468295219189806`*^9}, {3.846829714132536*^9, 
   3.8468297147769403`*^9}, 3.846829770476872*^9, {3.8468367343621416`*^9, 
   3.846836740433859*^9}, {3.8468368184982905`*^9, 3.846836818986068*^9}, {
   3.8468376554587145`*^9, 3.846837660004117*^9}, {3.8468382162411404`*^9, 
   3.8468382198736067`*^9}, {3.8468382731475267`*^9, 
   3.8468383406590633`*^9}, {3.846838396428229*^9, 3.8468384008191967`*^9}, {
   3.8468472200165663`*^9, 3.846847221363595*^9}, {3.8468478649999065`*^9, 
   3.8468478670945644`*^9}, {3.8468491478061705`*^9, 
   3.8468491502317123`*^9}, {3.846849808653754*^9, 3.846849809929842*^9}, {
   3.8468499445745735`*^9, 3.84684994788789*^9}, {3.847444433002282*^9, 
   3.8474444341113186`*^9}, {3.8479565550591283`*^9, 3.8479565561243076`*^9}, 
   3.8479584002362967`*^9, 3.847958889635376*^9, 3.8479589355907516`*^9, 
   3.8479593282027287`*^9, 3.847961680799029*^9, {3.8480390910382395`*^9, 
   3.848039092217394*^9}, {3.8480394826619787`*^9, 3.8480394834092846`*^9}, {
   3.848040227238947*^9, 3.848040233605711*^9}, {3.8480432756919456`*^9, 
   3.8480432763426332`*^9}, {3.8480433387886744`*^9, 
   3.8480433395105877`*^9}, {3.854635135575929*^9, 3.854635143063056*^9}, {
   3.8546353048539505`*^9, 3.854635310385127*^9}, {3.8546361587395926`*^9, 
   3.8546361589820004`*^9}, {3.854723029087531*^9, 3.8547230380861025`*^9}, {
   3.8547230952710233`*^9, 3.8547230963273664`*^9}, {3.854811196436452*^9, 
   3.854811215124194*^9}, {3.8548228668299527`*^9, 3.854822867515088*^9}, 
   3.854823793720137*^9, 3.8606963696633587`*^9, {3.8615985970465927`*^9, 
   3.861598599006845*^9}, {3.861600132373684*^9, 3.8616001370973067`*^9}, {
   3.861724596314806*^9, 3.861724601881921*^9}, 3.8617762678673763`*^9, {
   3.8617791439652243`*^9, 3.8617791454780593`*^9}, 3.86178725989005*^9, 
   3.8617915019514894`*^9, {3.861791540787301*^9, 3.8617915553660483`*^9}, {
   3.8618777597683935`*^9, 3.8618778246299534`*^9}, 3.8623832640750103`*^9, {
   3.8852949994424696`*^9, 3.885295027958845*^9}, {3.8852950768516197`*^9, 
   3.885295099481221*^9}, {3.885295147676483*^9, 3.8852951600188026`*^9}, {
   3.8853805948029346`*^9, 3.885380595700157*^9}, {3.885402555673275*^9, 
   3.885402556708188*^9}, {3.888485789546218*^9, 3.8884857942821302`*^9}, {
   3.8884941328875313`*^9, 3.888494136251226*^9}, {3.8889240760145288`*^9, 
   3.888924084593076*^9}, {3.889011302374075*^9, 3.889011325056558*^9}, 
   3.8890114191910796`*^9, {3.889015894015092*^9, 3.8890159001264696`*^9}, 
   3.8890343698106813`*^9, {3.8890435816504974`*^9, 3.8890435818337193`*^9}, {
   3.889114993091215*^9, 3.8891149941964664`*^9}, {3.889115539161128*^9, 
   3.8891155456820893`*^9}, {3.8893007430483522`*^9, 
   3.8893007551364975`*^9}, {3.889300949062793*^9, 3.8893009627558208`*^9}, {
   3.8896388605138426`*^9, 3.8896388623851347`*^9}, {3.889640329470795*^9, 
   3.889640330376751*^9}, 3.889898362002493*^9, {3.890076882746663*^9, 
   3.8900768832226734`*^9}, {3.890305002612569*^9, 3.8903050182372637`*^9}, {
   3.890388575510442*^9, 3.8903885769517455`*^9}, {3.89055306998922*^9, 
   3.8905530708704767`*^9}, {3.89343961069697*^9, 3.8934396113944054`*^9}, {
   3.894826302411278*^9, 3.89482633220352*^9}, {3.8994934047714405`*^9, 
   3.8994934055482483`*^9}, {3.899493551020452*^9, 3.899493577373485*^9}, {
   3.899494277276867*^9, 3.8994942795891523`*^9}, {3.899494721026575*^9, 
   3.899494721662327*^9}, {3.899494817258607*^9, 3.8994948180623817`*^9}, {
   3.8995653445448956`*^9, 3.8995653464184475`*^9}, {3.8997105546800747`*^9, 
   3.89971055735201*^9}, {3.8998888772412424`*^9, 3.899888892348868*^9}, {
   3.8998950925510635`*^9, 3.899895095169362*^9}, {3.8999019779141912`*^9, 
   3.8999019786777306`*^9}, {3.899916922182691*^9, 3.8999169839086695`*^9}, {
   3.900067041923176*^9, 3.900067042870823*^9}, 3.9006765045188417`*^9, {
   3.9071445854566984`*^9, 3.907144615960394*^9}, {3.927546919741806*^9, 
   3.9275470683699913`*^9}, {3.9275471166816344`*^9, 
   3.9275471238259497`*^9}, {3.927641906089526*^9, 3.927641925778685*^9}, {
   3.927728228766*^9, 3.9277282323595896`*^9}, {3.9278161954348545`*^9, 
   3.9278162281703215`*^9}, {3.92787807590646*^9, 3.9278780981843214`*^9}, {
   3.9278850441539726`*^9, 3.9278850447260528`*^9}, {3.927886554947821*^9, 
   3.9278865568822055`*^9}, {3.9306683449234657`*^9, 
   3.9306683461354675`*^9}, {3.930676134783606*^9, 3.930676150064254*^9}, 
   3.930739105101019*^9},ExpressionUUID->"beaec6fc-29f0-4523-aef2-\
66cb9807b124"]
}, Closed]],

Cell[CellGroupData[{

Cell["Data Processing ", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.821639993205228*^9}, {3.8381869586707425`*^9, 
   3.8381869649591913`*^9}, 3.838187468055561*^9, 3.8381890306710825`*^9, 
   3.8382140851103477`*^9},
 FontSize->24,ExpressionUUID->"8030b3f9-704c-4f14-a34c-1c106b3f9c9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"exportImageSequence", "[", 
    RowBox[{"images_", ",", "folder_", ",", "format_", ",", "compression_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"imageSequence", "=", "images"}], ",", 
       RowBox[{"exportFormat", "=", "format"}], ",", "\[IndentingNewLine]", 
       RowBox[{"exportFolder", "=", "folder"}], ",", 
       RowBox[{"compressionLevel", "=", "compression"}], ",", "k", ",", 
       "monitorCounter"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"monitorCounter", "=", "0"}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "@", "imageSequence"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Export", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "exportFolder", "<>", "$PathnameSeparator", "<>", 
               "\"\<Frame_\>\"", "<>", 
               RowBox[{"ToString", "@", "k"}], "<>", "exportFormat"}], ",", 
              RowBox[{"imageSequence", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"CompressionLevel", "\[Rule]", "compressionLevel"}]}], 
             "\[IndentingNewLine]", "]"}], ";", 
            RowBox[{"monitorCounter", "++"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"progress", "[", 
          RowBox[{"monitorCounter", ",", 
           RowBox[{"Length", "@", "imageSequence"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "//", "AbsoluteTiming"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exportImageSequenceWithSize", "[", 
   RowBox[{
   "images_", ",", "folder_", ",", "format_", ",", "compression_", ",", 
    "resolution_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"imageSequence", "=", "images"}], ",", 
      RowBox[{"exportFormat", "=", "format"}], ",", 
      RowBox[{"exportFolder", "=", "folder"}], ",", "\[IndentingNewLine]", 
      RowBox[{"compressionLevel", "=", "compression"}], ",", 
      RowBox[{"imageResolution", "=", "resolution"}], ",", "k", ",", 
      "monitorCounter"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"monitorCounter", "=", "0"}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", 
           RowBox[{"Length", "@", "imageSequence"}]}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Export", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "exportFolder", "<>", "$PathnameSeparator", "<>", 
              "\"\<Frame_\>\"", "<>", 
              RowBox[{"ToString", "@", "k"}], "<>", "exportFormat"}], ",", 
             RowBox[{"imageSequence", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"CompressionLevel", "\[Rule]", "compressionLevel"}], ",", 
             RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], 
            "\[IndentingNewLine]", "]"}], ";", 
           RowBox[{"monitorCounter", "++"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ",", 
        RowBox[{"progress", "[", 
         RowBox[{"monitorCounter", ",", 
          RowBox[{"Length", "@", "imageSequence"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}], "//", "AbsoluteTiming"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816685025014761*^9, 3.816685121824583*^9}, 
   3.8166851702611666`*^9, {3.8166853319319143`*^9, 3.8166853570017614`*^9}, {
   3.8166853921288576`*^9, 3.8166854430994287`*^9}, 3.8172933692699223`*^9, 
   3.8215213526898475`*^9, {3.8215219225755024`*^9, 3.821521924970554*^9}, {
   3.8215229316665196`*^9, 3.821522945393096*^9}, {3.821522980951149*^9, 
   3.8215229979667287`*^9}, {3.8215230467223215`*^9, 
   3.8215230604803877`*^9}, {3.8216285722586937`*^9, 
   3.8216285725139947`*^9}, {3.821628929343667*^9, 3.821628965792157*^9}, {
   3.8216290306326895`*^9, 3.8216292710985947`*^9}, {3.8216293014025493`*^9, 
   3.82162930963951*^9}, {3.821629370877658*^9, 3.821629377081064*^9}, {
   3.8216300310778837`*^9, 3.821630031732127*^9}, {3.8216383543553753`*^9, 
   3.8216383590896854`*^9}, {3.8216389284082756`*^9, 
   3.8216389842724094`*^9}, {3.821639232759909*^9, 3.8216392344633527`*^9}, {
   3.821639307842224*^9, 3.821639308720874*^9}, {3.821639585663513*^9, 
   3.821639599374831*^9}, {3.8216396491287265`*^9, 3.8216396501190767`*^9}, {
   3.8216429790351295`*^9, 3.8216429909672303`*^9}, {3.8374402327092*^9, 
   3.837440248492099*^9}, {3.83744424832545*^9, 3.8374442495444384`*^9}, {
   3.838186973248103*^9, 3.8381870424399757`*^9}, {3.838187423689406*^9, 
   3.838187441344855*^9}, {3.8381889975548377`*^9, 3.838189026392866*^9}, {
   3.838189332176097*^9, 3.838189337056424*^9}, {3.83818939578568*^9, 
   3.838189397793891*^9}, {3.8381897288247213`*^9, 3.838189749417483*^9}, {
   3.8382138820253506`*^9, 3.8382138841995373`*^9}, {3.838214072640682*^9, 
   3.8382141392226744`*^9}, {3.8382153711753535`*^9, 3.838215376439974*^9}, 
   3.8387032384222097`*^9, {3.838703732473629*^9, 3.8387037369775667`*^9}, {
   3.8428548039237576`*^9, 3.842854934305986*^9}, {3.842860282742243*^9, 
   3.8428602829875865`*^9}, {3.842870228415135*^9, 3.8428702291701164`*^9}, {
   3.842870267846715*^9, 3.8428702742944756`*^9}, {3.8429556294353204`*^9, 
   3.8429556394117627`*^9}, 3.8429557446139927`*^9, {3.8429558134350357`*^9, 
   3.8429558351643076`*^9}, {3.843042091380003*^9, 3.843042092644679*^9}, {
   3.8466805217818155`*^9, 3.8466805561470957`*^9}, {3.8466817589565873`*^9, 
   3.846681760002698*^9}, {3.846830318068039*^9, 3.8468303227811403`*^9}, {
   3.846836794250393*^9, 3.846836795673586*^9}, {3.8468388032090836`*^9, 
   3.8468388042609167`*^9}, {3.846850990461435*^9, 3.846850991216034*^9}, {
   3.846851762069357*^9, 3.8468517629910154`*^9}, {3.8468570654987984`*^9, 
   3.846857066510357*^9}, {3.847176357203411*^9, 3.847176365642843*^9}, {
   3.847181268905512*^9, 3.847181280689003*^9}, 3.8479584078119354`*^9, {
   3.8480397232691083`*^9, 3.848039727605297*^9}, {3.8480399095730343`*^9, 
   3.8480399149990773`*^9}, {3.8480400878616786`*^9, 
   3.8480400888955398`*^9}, {3.848040138181182*^9, 3.8480401392481413`*^9}, {
   3.8480403111972227`*^9, 3.8480403127980833`*^9}, {3.848043112108138*^9, 
   3.848043112566221*^9}, {3.861733656133502*^9, 3.8617338662603717`*^9}, {
   3.86176934714069*^9, 3.8617693724140406`*^9}, 3.861778568938816*^9, {
   3.8622430503751097`*^9, 3.862243051090524*^9}, 3.8623736077235756`*^9, 
   3.88529497097243*^9, {3.888494118454095*^9, 3.888494145667081*^9}, {
   3.889090822505982*^9, 3.8890908232189107`*^9}, {3.8891090862595997`*^9, 
   3.8891090868162723`*^9}, {3.8892483477682085`*^9, 
   3.8892483484480977`*^9}, {3.8892498055888453`*^9, 
   3.8892498082206764`*^9}, {3.889276229104906*^9, 3.889276267385105*^9}, {
   3.8898983886186423`*^9, 3.889898449060826*^9}, {3.8899041659732947`*^9, 
   3.889904166712389*^9}, {3.890046170318183*^9, 3.890046209900818*^9}, {
   3.8900462659591503`*^9, 3.890046270599622*^9}, {3.8900654002298822`*^9, 
   3.8900654016140833`*^9}, {3.890066092862156*^9, 3.890066129819665*^9}, {
   3.890067445284498*^9, 3.8900674463071547`*^9}, {3.890067542821095*^9, 
   3.8900675433292036`*^9}, {3.8900781043227777`*^9, 3.890078125443683*^9}, {
   3.890129641754139*^9, 3.890129650377389*^9}, {3.8901317774575396`*^9, 
   3.8901317809112263`*^9}, {3.8902029948095384`*^9, 
   3.8902029998603096`*^9}, {3.8902037672795553`*^9, 
   3.8902038129977217`*^9}, {3.8907333058606453`*^9, 3.890733306698245*^9}, 
   3.8907333399987135`*^9, {3.8908333871438456`*^9, 3.8908333985443945`*^9}, {
   3.890843513968988*^9, 3.890843560646533*^9}, {3.893095144175351*^9, 
   3.893095150510409*^9}, {3.893142205642288*^9, 3.893142206738003*^9}, {
   3.8946319308259935`*^9, 3.8946319383768206`*^9}, {3.8946376626404037`*^9, 
   3.8946376633071947`*^9}, {3.894715669204131*^9, 3.894715679293622*^9}, {
   3.894715769660548*^9, 3.8947157706182175`*^9}, {3.894715818389233*^9, 
   3.8947158352612343`*^9}, 3.8947299834526567`*^9, {3.894826295064418*^9, 
   3.8948263268873425`*^9}, {3.8985926459191093`*^9, 
   3.8985926572490215`*^9}, {3.898675733421308*^9, 3.898675737324503*^9}, {
   3.8986855128120303`*^9, 3.8986855135492887`*^9}, {3.89875942088224*^9, 
   3.8987594245157175`*^9}, {3.8987638701375003`*^9, 
   3.8987638708129883`*^9}, {3.8996642710019073`*^9, 
   3.8996642778906364`*^9}, {3.899709954541397*^9, 3.899709955639675*^9}, {
   3.900143571076066*^9, 3.9001435805339766`*^9}, 3.900251863220096*^9, {
   3.900264734620539*^9, 3.9002647637092133`*^9}, {3.9002729201746664`*^9, 
   3.900272922936228*^9}, {3.900509768608174*^9, 3.9005098198199806`*^9}, {
   3.9005100051660786`*^9, 3.9005100323425465`*^9}, {3.900510097989289*^9, 
   3.900510099326236*^9}, {3.900575926214774*^9, 3.9005759718143387`*^9}, {
   3.900590587514408*^9, 3.9005906191884975`*^9}, {3.9031993647049975`*^9, 
   3.9031993657430224`*^9}, {3.903199952967141*^9, 3.9031999537482214`*^9}, {
   3.9032001797431173`*^9, 3.9032001812747664`*^9}, 3.9033631012274704`*^9, {
   3.927547130086377*^9, 3.927547202942417*^9}, {3.9275472411672792`*^9, 
   3.927547340628725*^9}, {3.927642009022958*^9, 3.9276420154772835`*^9}, 
   3.9277304428262978`*^9, {3.927887110937085*^9, 3.927887111683267*^9}, {
   3.9306649922084007`*^9, 3.9306649941235647`*^9}, {3.93067617400422*^9, 
   3.9306762002392426`*^9}},ExpressionUUID->"25de1078-bc4a-4399-9c4b-\
3250768822a8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.821639993205228*^9}, {3.8381869586707425`*^9, 
   3.8381869649591913`*^9}, 3.838187468055561*^9, 3.8381890306710825`*^9, {
   3.8382140851103477`*^9, 3.838214092870597*^9}},
 FontSize->24,ExpressionUUID->"79f94e50-5c8b-4fab-b397-bdcb801b3455"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getMaskOverlays", "[", 
    RowBox[{"image_", ",", "mask_", ",", "color_", ",", "thickness_"}], "]"}],
    ":=", 
   RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ImageAdjust", "@", "image"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ColorReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"White", "\[Rule]", "color"}]}], "]"}], "&"}], "@", 
        RowBox[{"Binarize", "@", 
         RowBox[{"GaussianFilter", "[", 
          RowBox[{"#", ",", "thickness"}], "]"}]}]}], "&"}], "@", 
      RowBox[{"EdgeDetect", "@", "mask"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getLatexStyling", "[", "latexInput_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MaTeX", "[", 
       RowBox[{"#", ",", 
        RowBox[{"FontSize", "\[Rule]", 
         RowBox[{"fontSize", "+", "2"}]}]}], "]"}], "&"}], "@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"\"\<\\\\boldsymbol{\>\"", "<>", 
       RowBox[{"ToString", "@", "#"}], "<>", "\"\<}\>\""}], 
      "\[IndentingNewLine]", ")"}]}], "&"}], "@", "latexInput"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8382141089276686`*^9, 3.8382141470557327`*^9}, {
   3.8383810384782114`*^9, 3.838381047604392*^9}, {3.8387855585815835`*^9, 
   3.8387855587734413`*^9}, {3.8428550422523947`*^9, 3.842855063443738*^9}, {
   3.842870277711341*^9, 3.8428702783037567`*^9}, {3.8430443574775066`*^9, 
   3.8430443581598406`*^9}, {3.843306412936756*^9, 3.843306413797443*^9}, {
   3.8433074774747143`*^9, 3.8433074795321846`*^9}, {3.8434791180537205`*^9, 
   3.843479122197983*^9}, {3.8434792010384073`*^9, 3.8434792085272436`*^9}, {
   3.8434801865205216`*^9, 3.8434801872356105`*^9}, {3.8468295524204054`*^9, 
   3.846829553281579*^9}, {3.8468303011644278`*^9, 3.846830309764868*^9}, {
   3.8468366770818214`*^9, 3.8468366776273637`*^9}, {3.846837834713642*^9, 
   3.8468378625222187`*^9}, {3.8468455070247407`*^9, 3.846845510560229*^9}, {
   3.84684815828109*^9, 3.8468481614473963`*^9}, {3.8468520157107143`*^9, 
   3.846852020830513*^9}, {3.846857168227646*^9, 3.8468571689972773`*^9}, {
   3.8471814143775034`*^9, 3.8471814167940416`*^9}, {3.847517395217419*^9, 
   3.847517396149927*^9}, {3.8475193211014194`*^9, 3.8475193256496277`*^9}, {
   3.847703442796735*^9, 3.8477034453400145`*^9}, {3.847704978874587*^9, 
   3.84770498491438*^9}, {3.847958174636939*^9, 3.847958175546935*^9}, {
   3.8479584112620754`*^9, 3.847958418107979*^9}, {3.8479584533121324`*^9, 
   3.8479584698383713`*^9}, 3.847958503411874*^9, 3.8479587019715586`*^9, 
   3.8479587489015484`*^9, {3.848039611709918*^9, 3.8480396130401764`*^9}, {
   3.854284348606432*^9, 3.854284414507883*^9}, {3.8542844460535684`*^9, 
   3.854284450163246*^9}, {3.8542844897272644`*^9, 3.854284491163439*^9}, {
   3.8542846894363155`*^9, 3.8542847196534653`*^9}, {3.854284763132161*^9, 
   3.854284805203933*^9}, {3.8543017093581405`*^9, 3.8543017097800107`*^9}, 
   3.8543021687449975`*^9, {3.86135180587704*^9, 3.861351833608179*^9}, {
   3.8613521906884565`*^9, 3.861352244163921*^9}, 3.8613523774468827`*^9, 
   3.8613527808945127`*^9, {3.861352819172843*^9, 3.8613528224911113`*^9}, {
   3.861353079779817*^9, 3.8613530820279865`*^9}, {3.861353182755934*^9, 
   3.861353198595103*^9}, {3.8613532465402184`*^9, 3.86135328889894*^9}, {
   3.861353351435895*^9, 3.861353359444062*^9}, {3.861442430138591*^9, 
   3.8614424558068857`*^9}, {3.861442950672676*^9, 3.861442980099907*^9}, {
   3.861443951145012*^9, 3.861444010521378*^9}, {3.8614442545310187`*^9, 
   3.8614442566662717`*^9}, {3.8614443760482197`*^9, 
   3.8614444124822063`*^9}, {3.861444936929628*^9, 3.8614449419627314`*^9}, {
   3.8617694039719276`*^9, 3.861769404845587*^9}, {3.8618714154161644`*^9, 
   3.861871441937232*^9}, 3.8618714766948304`*^9, {3.8618715377453823`*^9, 
   3.861871539470315*^9}, {3.8618715963929563`*^9, 3.861871600951092*^9}, {
   3.8618726375592003`*^9, 3.8618726398618665`*^9}, {3.861873404718047*^9, 
   3.8618734265576353`*^9}, 3.885294884064336*^9, {3.8852949158047347`*^9, 
   3.88529492197764*^9}, {3.885377905840366*^9, 3.8853779077071247`*^9}, {
   3.885402114857448*^9, 3.8854021282003307`*^9}, 3.8886943092933555`*^9, {
   3.889015442136024*^9, 3.889015456919775*^9}, {3.8892762475930476`*^9, 
   3.8892762562558956`*^9}, 3.8893009772205563`*^9, {3.8899841131691065`*^9, 
   3.8899841141759653`*^9}, {3.890047708116598*^9, 3.8900477146782904`*^9}, {
   3.8900675087873*^9, 3.8900675121149426`*^9}, {3.8902029366355205`*^9, 
   3.890202989738862*^9}, {3.8902039833760834`*^9, 3.890203984629099*^9}, {
   3.8904086075627317`*^9, 3.890408613241494*^9}, {3.890632148860849*^9, 
   3.890632158460635*^9}, 3.8906322433101892`*^9, {3.8907331951512904`*^9, 
   3.890733215470951*^9}, {3.8928938569995413`*^9, 3.8928938576698256`*^9}, {
   3.8941055556590333`*^9, 3.8941055565294847`*^9}, 3.8946216133283796`*^9, 
   3.8948263490958805`*^9, {3.8985945927999134`*^9, 3.8985945934481864`*^9}, {
   3.898759385267237*^9, 3.8987593894367065`*^9}, {3.899648467182111*^9, 
   3.8996484676838007`*^9}, {3.8996643286176662`*^9, 3.899664329528232*^9}, 
   3.9003109355727468`*^9, 3.900406906742863*^9, 3.90040861264791*^9, 
   3.9275473655427713`*^9, 3.927860762733488*^9, {3.927887869031811*^9, 
   3.9278878718077097`*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"ae9e466b-1b82-4bc9-8437-553d8b171e20"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ Image Preview ]]", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 3.8468307830344753`*^9}, {3.8852951251696224`*^9, 
  3.885295127082173*^9}, {3.889042301650259*^9, 3.8890423048838863`*^9}, {
  3.8892728459663477`*^9, 
  3.88927284778979*^9}},ExpressionUUID->"6f2a1bc0-34e9-4b61-a42e-\
db38886ab52b"],

Cell["\<\
Defaults :
   
rotationSwitch=0;
rotationAngle=\[Pi]/2;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.890277324764104*^9, {
   3.8998652744622345`*^9, 3.8998652822264137`*^9}, 3.9071421727157497`*^9, {
   3.9276416603605146`*^9, 3.9276416628006225`*^9}},
 FontSize->16,ExpressionUUID->"70a7e316-d568-4003-93b0-4e5d38523426"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rotationSwitch", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotationAngle", "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9071421576540365`*^9, 3.907142161291154*^9}, {
   3.907142194914836*^9, 3.9071422007718105`*^9}, {3.915102385393812*^9, 
   3.915102385521206*^9}, 3.9151043611222196`*^9, 3.9275474000346847`*^9, {
   3.927641565507367*^9, 3.9276415763373404`*^9}, {3.927730644037423*^9, 
   3.927730657576763*^9}, 3.93058794234702*^9, 3.930590415999978*^9},
 CellLabel->
  "In[295]:=",ExpressionUUID->"342563f0-589e-42ec-965b-36366f32c18a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"previewImages", "=", "images"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"viewImage", "@", 
    RowBox[{"rotateImage", "@", 
     RowBox[{"(*", 
      RowBox[{"ColorToneMapping", "@"}], "*)"}], 
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"previewImages", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "previewImages"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.847348164976734*^9, 3.8473482034795685`*^9}, {
   3.8473587967119102`*^9, 3.84735880759993*^9}, {3.8473590742000065`*^9, 
   3.847359106208709*^9}, {3.847359452569849*^9, 3.8473595079603925`*^9}, {
   3.8473595389841976`*^9, 3.847359539120832*^9}, {3.8474397485342627`*^9, 
   3.8474397553889327`*^9}, {3.8852951986578484`*^9, 3.88529520428992*^9}, {
   3.8852958562998705`*^9, 3.8852958631861887`*^9}, {3.907142125571265*^9, 
   3.9071421445497613`*^9}, 3.9151023976373863`*^9, {3.9275475337624264`*^9, 
   3.9275475351403418`*^9}, 3.9306650111347113`*^9},
 CellLabel->
  "In[297]:=",ExpressionUUID->"1ea10bda-d7ad-42b8-b0e4-58111a06e837"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Crop Images", "Section",
 CellChangeTimes->{{3.888313862470392*^9, 3.888313878259631*^9}, {
  3.88832166456643*^9, 
  3.888321665910595*^9}},ExpressionUUID->"6233e718-0804-4d1a-8f9a-\
abf48485703c"],

Cell[CellGroupData[{

Cell["Crop Images", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.888486151680708*^9}, {3.927728901913908*^9, 3.9277289054972305`*^9}, 
   3.92772927400146*^9},
 FontSize->24,ExpressionUUID->"04fe44c9-dd63-4913-9b0e-c423827ea7e6"],

Cell[CellGroupData[{

Cell["Set Crop Boundaries", "Subsubsection",
 CellChangeTimes->{{3.9303920158098435`*^9, 
  3.9303920282311993`*^9}},ExpressionUUID->"226725fa-b137-4e13-8452-\
83effc76d73c"],

Cell["\<\
Defaults :
   
selectedImages=1;;All;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, 3.9010341626470175`*^9, 3.901050201650057*^9, 
   3.9011063688737135`*^9},
 FontSize->16,ExpressionUUID->"ea9edec7-9869-4ebf-9070-755d668f86d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"selectedImages", "=", 
   RowBox[{"1", ";;", "All"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.89876929180124*^9, 3.8987693095602007`*^9}, 
   3.898769618408449*^9, {3.9010501473852425`*^9, 3.9010501477292156`*^9}, 
   3.9010925475579243`*^9, 3.901106354561016*^9, {3.901106400031975*^9, 
   3.901106401264494*^9}, 3.901107802769897*^9, {3.901108134513094*^9, 
   3.9011081364976063`*^9}, {3.903862636401534*^9, 3.903862650905411*^9}, {
   3.9054453382875657`*^9, 3.9054453542881613`*^9}, 3.926859890298006*^9, {
   3.9272893308098392`*^9, 3.92728933134527*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"afa39e2d-a25c-430f-9c9c-d0ed406d5972"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sequenceImages", "=", 
    RowBox[{"images", "[", 
     RowBox[{"[", "selectedImages", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"testImage", "=", 
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"sequenceImages", "[", 
       RowBox[{"[", "imageID", "]"}], "]"}]}]}], ";", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"width", ",", "height"}], "}"}], "=", 
     RowBox[{"ImageDimensions", "@", "testImage"}]}], ";", "\n", 
    "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Grid", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{"testImage", ",", "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"EdgeForm", "[", 
                RowBox[{"{", 
                 RowBox[{"Yellow", ",", 
                  RowBox[{"Thickness", "@", "0.0035"}]}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Opacity", "@", "0.10"}], ",", "Yellow", ",", 
               RowBox[{"Rectangle", "@@", "points"}]}], "}"}], 
             "\[IndentingNewLine]", "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "525"}]}], "\[IndentingNewLine]", 
           "]"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"croppedImage", "=", 
             RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
              RowBox[{"testImage", ",", "\[IndentingNewLine]", 
               RowBox[{"rowRange", "=", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"height", "-", 
                  RowBox[{"points", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"columnRange", "=", 
                RowBox[{"points", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"UpTo", "@", "450"}]}]}], "\[IndentingNewLine]", "]"}], 
          "}"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"points", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"width", ",", "height"}], "}"}], "/", "2"}]}], "}"}]}], 
         "}"}], ",", "Locator"}], "\[IndentingNewLine]", "}"}]}], "]"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"imageID", ",", "1", ",", 
     RowBox[{"Length", "@", "sequenceImages"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.877374989415597*^9, 3.8773750036916785`*^9}, {
   3.8773750355847387`*^9, 3.8773750405770674`*^9}, {3.8773750796454935`*^9, 
   3.8773752099007215`*^9}, {3.877375249289606*^9, 3.877375306156417*^9}, {
   3.877375350183156*^9, 3.8773753596606655`*^9}, {3.8773754875524025`*^9, 
   3.8773754985733185`*^9}, {3.877375582441363*^9, 3.877375617151244*^9}, {
   3.8773763307806625`*^9, 3.877376332602451*^9}, {3.8773767213676643`*^9, 
   3.8773767737001653`*^9}, {3.877376961514588*^9, 3.8773769624325247`*^9}, {
   3.877377025017548*^9, 3.8773770354890585`*^9}, 3.8773770897698135`*^9, {
   3.8773772182335863`*^9, 3.8773772210328712`*^9}, {3.8773775994976454`*^9, 
   3.877377628833558*^9}, {3.8773776701768255`*^9, 3.8773776978996763`*^9}, {
   3.8773799030145936`*^9, 3.8773799168366785`*^9}, {3.87737995980272*^9, 
   3.8773799600600195`*^9}, {3.8773815112975636`*^9, 
   3.8773815175225506`*^9}, {3.8773815740668592`*^9, 
   3.8773815798208094`*^9}, {3.8773817006335773`*^9, 
   3.8773817574597917`*^9}, {3.877382027314622*^9, 3.8773820290337963`*^9}, {
   3.877382866204748*^9, 3.8773829105266013`*^9}, {3.8773830170897183`*^9, 
   3.8773831043927875`*^9}, {3.87738315012831*^9, 3.877383167672226*^9}, {
   3.877453763906587*^9, 3.877453849664575*^9}, {3.877515428424682*^9, 
   3.877515477863963*^9}, {3.8777171265330076`*^9, 3.87771713790848*^9}, {
   3.8777172386365623`*^9, 3.877717251874132*^9}, 3.877779044561672*^9, {
   3.878130848265929*^9, 3.87813084939392*^9}, 3.878322141765069*^9, {
   3.888313884476748*^9, 3.888313889580989*^9}, {3.888335011698847*^9, 
   3.8883350118979816`*^9}, 3.888395625409953*^9, {3.89876863302799*^9, 
   3.898768633384777*^9}, 3.8987693047700453`*^9, {3.9010925598298883`*^9, 
   3.901092570304926*^9}, {3.9277305264828405`*^9, 3.927730553953071*^9}, {
   3.9277305842746677`*^9, 3.927730613457284*^9}, 3.9303920595584826`*^9, 
   3.9305844577533083`*^9, 3.9305845614700685`*^9, 3.930584775854352*^9, 
   3.9305872305080013`*^9, 3.930665401881985*^9, {3.9306657616363354`*^9, 
   3.930665767350074*^9}, 
   3.9306762249588995`*^9},ExpressionUUID->"b3029616-4ce4-4f1b-8de2-\
267d5d39b5da"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Crop Images", "Subsubsection",
 CellChangeTimes->{{3.9303920158098435`*^9, 
  3.930392044606351*^9}},ExpressionUUID->"f77be009-3cc1-4a17-bc70-\
2a7a48245b50"],

Cell["\<\
Optional:

For experiments with identical FOV for all runs,
evaluate \[OpenCurlyQuote]{rowRange,columnRange}\[CloseCurlyQuote] after \
setting crop boundaries;
copy the output to the \[OpenCurlyQuote]memorizedRowColumnRanges\
\[CloseCurlyQuote] definition
Comment (disable, with \[OpenCurlyDoubleQuote]Alt + \
/\[CloseCurlyDoubleQuote], enabling again  works the same) the crop setter \
module
Leave the \[OpenCurlyQuote]selectedImages\[CloseCurlyQuote] and \
\[OpenCurlyQuote]sequenceImages\[CloseCurlyQuote] definitions active\
\>", "Abstract",
 CellChangeTimes->{{3.888922906196766*^9, 3.8889229194346066`*^9}, {
  3.894804961323394*^9, 3.894804965269334*^9}, {3.930291325113571*^9, 
  3.9302913434852905`*^9}, {3.9306338576574726`*^9, 3.930634049619918*^9}, {
  3.9306340896974316`*^9, 3.9306340918488035`*^9}, {3.930634306369034*^9, 
  3.93063446933704*^9}},
 FontSize->16,ExpressionUUID->"17396fb9-0d83-4217-acfa-067fd7eec6f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{"rowRange", ",", "columnRange"}], "}"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"memorizedRowColumnRanges", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1024"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"350", ",", "847"}], "}"}]}], "}"}]}], ";"}], 
   "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.930390911758029*^9, 3.9303909157415476`*^9}, {
   3.930391438849575*^9, 3.9303914412996445`*^9}, {3.93040625491666*^9, 
   3.9304062602018824`*^9}, {3.930584507404461*^9, 3.930584546275426*^9}, 
   3.930584863228325*^9, {3.9305855625700684`*^9, 3.9305855707545133`*^9}, 
   3.9305856224011574`*^9, 3.9305858685878906`*^9, 3.930587267548441*^9, 
   3.930587962161962*^9, {3.9306650637246475`*^9, 3.930665064206808*^9}, 
   3.930676235861225*^9},ExpressionUUID->"f314ec14-7bf0-4a77-bdc4-\
1ade4f97a4aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rowRange", ",", "columnRange"}], "}"}], "=", 
    "memorizedRowColumnRanges"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rowRange", ",", "columnRange"}], "}"}], "//", "TableForm"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"rotateImage", "@", 
        RowBox[{"ImageAdjust", "@", 
         RowBox[{"Image", "[", 
          RowBox[{"#", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}]}], "&"}], 
      "@", 
      RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sequenceImages", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        "rowRange", ",", "columnRange"}], "\[IndentingNewLine]", "]"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "@", "sequenceImages"}], ",", "1"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.877377507276599*^9, 3.8773775535996113`*^9}, {
   3.877377789922418*^9, 3.877377806279915*^9}, 3.8773799921662216`*^9, {
   3.8773818265707884`*^9, 3.877381843020713*^9}, {3.8773820738765965`*^9, 
   3.8773820756908646`*^9}, {3.877434221064697*^9, 3.8774342249785385`*^9}, {
   3.901016752157523*^9, 3.901016759782638*^9}, {3.9011067865842185`*^9, 
   3.9011067876811714`*^9}, {3.9011741932935205`*^9, 
   3.9011741944827547`*^9}, {3.9011884938375587`*^9, 
   3.9011884943818655`*^9}, {3.9277306739262977`*^9, 3.927730682769347*^9}, {
   3.9303909276706333`*^9, 3.9303909484734936`*^9}, 3.93040626250348*^9, 
   3.9305845119938965`*^9, 3.930584551075316*^9, {3.9305848676341867`*^9, 
   3.930584870698553*^9}, {3.9305849802761445`*^9, 3.9305849812587147`*^9}, {
   3.9305855745321765`*^9, 3.9305855796193695`*^9}, 3.9305856202288275`*^9, 
   3.930585870864468*^9, 
   3.930676238684761*^9},ExpressionUUID->"ab2fdad6-c23c-49da-95bb-\
dfaa9280f20f"],

Cell["\<\
Defaults :
   
imageIndices=1;;All;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, 3.9010341626470175`*^9, 3.901050201650057*^9},
 FontSize->16,ExpressionUUID->"c66e71a4-d2c4-468e-a64d-6df5da6dcbf3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"imageIndices", "=", 
   RowBox[{"1", ";;", "All"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9010341179795713`*^9, 3.9010341412383795`*^9}, {
   3.9010501986190166`*^9, 3.9010501988492575`*^9}, {3.9011758860437098`*^9, 
   3.901175888239133*^9}, {3.9011763221740255`*^9, 3.9011763236382313`*^9}, {
   3.9011842440688753`*^9, 3.9011842645264044`*^9}, 3.901184596434497*^9, {
   3.9011869396056814`*^9, 3.901186939925429*^9}, 3.901187028032392*^9, {
   3.9011881310856867`*^9, 3.9011881411437864`*^9}, {3.9011885951976113`*^9, 
   3.9011885954655223`*^9}, {3.9038526654482193`*^9, 3.9038526668634353`*^9}, 
   3.903852721063405*^9, {3.9038528713754816`*^9, 3.903852871827273*^9}, 
   3.9038626551772213`*^9, 3.903871296619178*^9, {3.905445420222046*^9, 
   3.905445421712035*^9}, {3.9054458030810037`*^9, 3.905445803390708*^9}, {
   3.9054459270965233`*^9, 3.9054459288464217`*^9}, {3.905446225689576*^9, 
   3.9054462259433875`*^9}, {3.9054552827663283`*^9, 
   3.9054552829579134`*^9}, {3.905455829471774*^9, 3.905455830469693*^9}, {
   3.9054559815420876`*^9, 3.9054559819425783`*^9}, {3.9054561093749046`*^9, 
   3.905456110885648*^9}, 3.905456368510189*^9, {3.927515860760809*^9, 
   3.9275158611682963`*^9}, {3.930584574124233*^9, 3.9305845762267656`*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"c3cc8725-ff6e-4d39-bc5e-7065d8b6a093"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"croppedImages", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ImageTake", "[", 
         RowBox[{"#", ",", "rowRange", ",", "columnRange"}], "]"}], "&"}], "/@",
        "\[IndentingNewLine]", 
       RowBox[{"sequenceImages", "[", 
        RowBox[{"[", "imageIndices", "]"}], "]"}]}], "//", "Parallelize"}]}], 
    ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"First", "@", "croppedImages"}], "//", "ImageDimensions"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8883199125691833`*^9, 3.8883199277064157`*^9}, {
   3.901008465957751*^9, 3.9010084666706953`*^9}, {3.9010114234787903`*^9, 
   3.901011427231417*^9}, {3.9010161219957676`*^9, 3.901016122999207*^9}, {
   3.901017566811705*^9, 3.9010175671637816`*^9}, {3.9010179419963865`*^9, 
   3.901017942286087*^9}, {3.9010340740540032`*^9, 3.9010340743891463`*^9}, 
   3.9010341485698442`*^9, {3.9277306910808616`*^9, 3.927730693760558*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"a922cb99-7c34-47d2-ae7f-5811cc56be34"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Cropped Images >>", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.888486151680708*^9}, {3.927728901913908*^9, 3.9277289054972305`*^9}, 
   3.9277292703217473`*^9},
 FontSize->24,ExpressionUUID->"213b0299-69a4-47de-9aa0-bf3381e13be8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"croppedImagesFolder", "=", 
   RowBox[{"output", "<>", "\"\<1 Cropped Images\>\""}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"croppedImagesFolder", "//", "CreateDirectory"}], ";"}], "//", 
   "Quiet"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImageSequence", "[", "\[IndentingNewLine]", 
    RowBox[{
    "croppedImages", ",", "croppedImagesFolder", ",", "\"\<.tiff\>\"", ",", 
     "0"}], "\[IndentingNewLine]", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8892817493431044`*^9, 3.8892817805519447`*^9}, {
   3.889281837143244*^9, 3.88928191320846*^9}, {3.8892819594009056`*^9, 
   3.889281979209507*^9}, {3.8892821229194517`*^9, 3.8892821513839016`*^9}, {
   3.889621126101282*^9, 3.8896211918063293`*^9}, 3.8896214994948688`*^9, {
   3.8896215537218475`*^9, 3.889621561789811*^9}, {3.8896216430248423`*^9, 
   3.8896216457023907`*^9}, 3.8896216789445276`*^9, {3.8896220419612627`*^9, 
   3.8896220975531425`*^9}, {3.889623340867552*^9, 3.8896233411228905`*^9}, {
   3.8899819697164917`*^9, 3.889981979009638*^9}, 3.889982019469488*^9, {
   3.8899820760598574`*^9, 3.8899820783107395`*^9}, {3.890046229067525*^9, 
   3.890046277931983*^9}, {3.890527335932677*^9, 3.8905273362291927`*^9}, {
   3.899494914195033*^9, 3.8994949154990673`*^9}, {3.9152225301919775`*^9, 
   3.915222534823679*^9}, {3.9152225847640715`*^9, 3.9152226171491485`*^9}, {
   3.915223424822422*^9, 3.915223436343696*^9}, {3.9152234753578963`*^9, 
   3.915223478397222*^9}, {3.9152235935791206`*^9, 3.915223594570014*^9}, {
   3.915226334078206*^9, 3.9152263746314983`*^9}, {3.9156276078247695`*^9, 
   3.9156276080076075`*^9}, {3.927729684808256*^9, 3.927729697436305*^9}, {
   3.927729755369616*^9, 3.927729757136557*^9}, {3.9306650273917913`*^9, 
   3.9306650275800576`*^9}, 3.930665090863782*^9},
 CellLabel->
  "In[308]:=",ExpressionUUID->"3a9849a7-b51c-450d-be47-5c64c31fc2bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[">> Import Cropped Images <<", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.888486151680708*^9}, {3.927728901913908*^9, 3.9277289054972305`*^9}, 
   3.927729277961999*^9},
 FontSize->24,ExpressionUUID->"42bb92d9-9ad1-4eb1-9e75-7865bb3018ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"croppedImagesFolder", "=", 
   RowBox[{"output", "<>", "\"\<1 Cropped Images\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "@", "croppedImagesFolder"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"croppedImages", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"Import", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "croppedImagesFolder", "<>", "$PathnameSeparator", "<>", "#"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
           "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", "files"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896225359098797`*^9, 3.8896226218372874`*^9}, {3.88962271829244*^9, 
   3.8896227275498905`*^9}, {3.889623134636578*^9, 3.889623137861703*^9}, {
   3.889623351635437*^9, 3.889623352090786*^9}, {3.8896235050986195`*^9, 
   3.889623534803034*^9}, 3.8899815513595295`*^9, {3.8901546653652105`*^9, 
   3.890154666131366*^9}, {3.8903837878670807`*^9, 3.8903837896332626`*^9}, {
   3.8903838511865406`*^9, 3.890383858398181*^9}, 3.8903839043715124`*^9, {
   3.890384135310108*^9, 3.890384146650017*^9}, {3.890386917039728*^9, 
   3.8903869187284775`*^9}, {3.8904093272504597`*^9, 3.890409333525776*^9}, 
   3.890409366183757*^9, {3.890527338154413*^9, 3.8905273383735204`*^9}, {
   3.8988782099719763`*^9, 3.8988782104193707`*^9}, {3.900093179450349*^9, 
   3.9000932064248447`*^9}, {3.9152226218831253`*^9, 3.915222649675064*^9}, {
   3.9152234558563757`*^9, 3.915223457637218*^9}, {3.9152264040897427`*^9, 
   3.9152264238564825`*^9}, {3.915226696268087*^9, 3.9152266970928*^9}, {
   3.915623639142209*^9, 3.9156236478696947`*^9}, {3.915627606721238*^9, 
   3.9156276069032154`*^9}, {3.9277297497382855`*^9, 3.9277297498570185`*^9}, 
   3.9303941900713854`*^9, {3.9306650317814083`*^9, 3.9306650345893917`*^9}, 
   3.930665099910757*^9, 3.930665821366576*^9, 
   3.930676247660827*^9},ExpressionUUID->"f0d4fad0-94ea-42de-845a-\
7b8ffdcce6e1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Image Projections & Correction", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 3.8468307830344753`*^9}, {3.8852951251696224`*^9, 
  3.885295127082173*^9}, {3.889042301650259*^9, 3.8890423160585136`*^9}, {
  3.9000526688877544`*^9, 3.900052673095501*^9}, {3.9277271132687407`*^9, 
  3.927727117906391*^9}},ExpressionUUID->"5755cac6-3b25-4282-a496-\
56b79914411f"],

Cell[CellGroupData[{

Cell["Image Stack Projections", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
  3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
  3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
  3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
  3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
  3.888486151680708*^9}, {3.927728901913908*^9, 3.9277289054972305`*^9}},
 FontSize->24,ExpressionUUID->"490656a1-7045-4adf-b8e6-76f1cabd2196"],

Cell["\<\
Defaults :
   
rotationSwitch=1;
rotationAngle=\[Pi]/2;
checkupIDs=1;;All;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.890277324764104*^9, {
   3.8998652744622345`*^9, 3.8998652822264137`*^9}, 3.907142272681672*^9, {
   3.9071424629474955`*^9, 3.9071424656585665`*^9}, {3.927556989992026*^9, 
   3.9275569913752728`*^9}, 3.9277860107254353`*^9},
 FontSize->16,ExpressionUUID->"cfe5cba0-beef-4b11-8d7d-6683aa2e812d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rotationSwitch", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotationAngle", "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checkupIDs", "=", 
   RowBox[{"1", ";;", "All"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.885408382496828*^9, 3.8854083987486277`*^9}, {
   3.8854084986136913`*^9, 3.885408499268813*^9}, {3.885408593677886*^9, 
   3.8854086063801184`*^9}, {3.885409519131166*^9, 3.8854095763927016`*^9}, {
   3.890216468749096*^9, 3.890216501490799*^9}, {3.890216553203435*^9, 
   3.890216555819228*^9}, {3.8902772978538885`*^9, 3.890277302108052*^9}, {
   3.8908334266930494`*^9, 3.890833429726142*^9}, {3.8963692247707596`*^9, 
   3.896369230096441*^9}, {3.8964361643856163`*^9, 3.89643622317446*^9}, {
   3.89643675712685*^9, 3.896436757391596*^9}, {3.896437331514621*^9, 
   3.89643733292544*^9}, {3.907142260949374*^9, 3.9071422771250505`*^9}, {
   3.9071423835504045`*^9, 3.9071423939726815`*^9}, {3.907142451996209*^9, 
   3.9071424597399855`*^9}, {3.907142655891658*^9, 3.907142676766059*^9}, 
   3.915102520213099*^9, 3.9151043737240005`*^9, {3.927547562457056*^9, 
   3.9275475740420194`*^9}, {3.9275569651126027`*^9, 3.927556966503935*^9}, {
   3.9275570007680664`*^9, 3.927557001326572*^9}, {3.9277248342559233`*^9, 
   3.927724835099806*^9}, {3.9277860064475937`*^9, 3.92778600731692*^9}},
 CellLabel->
  "In[312]:=",ExpressionUUID->"a552173d-c230-4776-9277-63c03c42bb2e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"imageStack", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"rotateImage", "@", 
       RowBox[{"Image", "[", 
        RowBox[{
         RowBox[{"ColorCombine", "@", "#"}], ",", "\"\<Bit16\>\""}], "]"}]}], 
      "&"}], "@", 
     RowBox[{"croppedImages", "[", 
      RowBox[{"[", "checkupIDs", "]"}], "]"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToString", "@", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"ByteCount", "@", "imageStack"}], "/", 
      RowBox[{"1024", "^", "3"}]}], "]"}]}], "<>", "\"\< Gb\>\""}], "//", 
  "Print"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"memoryCheck", "[", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"imageForms", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Image", "[", 
         RowBox[{"#", ",", "Byte"}], "]"}], "&"}], "/@", 
       RowBox[{"ImageAdjust", "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rotateImage", "@", 
           RowBox[{"First", "@", "#"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"rotateImage", "@", 
           RowBox[{"Mean", "@", "#"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ImageApply", "[", 
             RowBox[{"Min", ",", "#"}], "]"}], "&"}], "@", "imageStack"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ImageApply", "[", 
             RowBox[{"StandardDeviation", ",", "#"}], "]"}], "&"}], "@", 
           "imageStack"}]}], "\[IndentingNewLine]", "}"}]}]}], "&"}], "@", 
     RowBox[{"croppedImages", "[", 
      RowBox[{"[", "checkupIDs", "]"}], "]"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.885408382496828*^9, 3.8854083987486277`*^9}, {
   3.8854084986136913`*^9, 3.885408499268813*^9}, {3.885408593677886*^9, 
   3.8854086063801184`*^9}, {3.885409519131166*^9, 3.8854095763927016`*^9}, {
   3.890216468749096*^9, 3.890216501490799*^9}, {3.890216553203435*^9, 
   3.890216555819228*^9}, {3.8902772978538885`*^9, 3.890277302108052*^9}, {
   3.8908334266930494`*^9, 3.890833429726142*^9}, {3.8963692247707596`*^9, 
   3.896369230096441*^9}, {3.8964361643856163`*^9, 3.8964363299489517`*^9}, {
   3.8964363877439537`*^9, 3.8964365422773743`*^9}, {3.896436599043357*^9, 
   3.8964366370728083`*^9}, {3.8964366671448145`*^9, 3.89643673724588*^9}, {
   3.8964367773351607`*^9, 3.896436778740844*^9}, {3.8964368224816637`*^9, 
   3.896436875022439*^9}, {3.8964369825451965`*^9, 3.8964370098803487`*^9}, {
   3.896437198809002*^9, 3.8964371998180475`*^9}, {3.8997967835223236`*^9, 
   3.8997968038311157`*^9}, {3.9060508213433585`*^9, 
   3.9060508397809877`*^9}, {3.9071422918299685`*^9, 
   3.9071423700852394`*^9}, {3.9071424812190485`*^9, 3.907142510564954*^9}, {
   3.907142585319785*^9, 3.9071426310756598`*^9}, {3.9151025047585974`*^9, 
   3.9151025778461523`*^9}, {3.9275569709383554`*^9, 3.927556980231744*^9}, 
   3.927601636738721*^9, {3.927602936464573*^9, 3.9276029377032924`*^9}, {
   3.9277248654303627`*^9, 3.9277248665668225`*^9}, {3.9277256978769436`*^9, 
   3.9277256997633724`*^9}, {3.927730716793502*^9, 3.9277307340081396`*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"cf94c8d2-4c96-4099-bebf-978587dcc2a1"],

Cell["\<\
Defaults :
   
rotationSwitch=1;
useCTMprojections=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.890277324764104*^9, {
   3.8998652744622345`*^9, 3.8998652822264137`*^9}, 3.907142272681672*^9, {
   3.9071424629474955`*^9, 3.9071424656585665`*^9}, {3.9275569949347553`*^9, 
   3.92755699524692*^9}, 3.9277258090361385`*^9, 3.927726921290244*^9},
 FontSize->16,ExpressionUUID->"eaad9514-e84a-4d37-b736-52e6dfaba045"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rotationSwitch", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"useCTMprojections", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.927557004965729*^9, 3.927557005250966*^9}, {
  3.9277256221403894`*^9, 3.9277256272947855`*^9}, {3.9277257265839353`*^9, 
  3.9277257298947725`*^9}, {3.9277257984947233`*^9, 3.9277257994286118`*^9}, {
  3.9277268712918673`*^9, 3.9277268782027807`*^9}, {3.9277269133110723`*^9, 
  3.9277269161543083`*^9}, {3.9277289200351305`*^9, 3.9277289206175194`*^9}, {
  3.930390959445553*^9, 3.930390960091462*^9}},
 CellLabel->
  "In[319]:=",ExpressionUUID->"b77e48b2-9012-4595-937f-e896bbc330c8"],

Cell[BoxData[
 RowBox[{"plotImageForms", "=", 
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Rasterize", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{"RasterSize", "\[Rule]", 
            RowBox[{"0.5", "*", 
             RowBox[{"ImageDimensions", "@", 
              RowBox[{"rotateImage", "@", 
               RowBox[{"First", "@", "images"}]}]}]}]}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "/@", 
        RowBox[{"Nest", "[", 
         RowBox[{"ColorToneMapping", ",", "#", ",", "useCTMprojections"}], 
         "]"}]}], "&"}], "/@", "imageForms"}], "//", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"#", ",", "2"}], "]"}], "&"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
    RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
    RowBox[{"Spacings", "\[Rule]", "5"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.885408382496828*^9, 3.8854083987486277`*^9}, {
   3.8854084986136913`*^9, 3.885408499268813*^9}, {3.885408593677886*^9, 
   3.8854086063801184`*^9}, {3.885409519131166*^9, 3.8854095763927016`*^9}, {
   3.890216468749096*^9, 3.890216501490799*^9}, {3.890216553203435*^9, 
   3.890216555819228*^9}, {3.8902772978538885`*^9, 3.890277302108052*^9}, {
   3.8908334266930494`*^9, 3.890833429726142*^9}, {3.8963692247707596`*^9, 
   3.896369230096441*^9}, {3.8964361643856163`*^9, 3.8964363299489517`*^9}, {
   3.8964363877439537`*^9, 3.8964365422773743`*^9}, {3.896436599043357*^9, 
   3.8964366370728083`*^9}, {3.8964366671448145`*^9, 3.89643673724588*^9}, {
   3.8964367773351607`*^9, 3.896436778740844*^9}, {3.8964368224816637`*^9, 
   3.896436875022439*^9}, {3.8964369825451965`*^9, 3.8964370098803487`*^9}, {
   3.896437198809002*^9, 3.8964371998180475`*^9}, {3.8997967835223236`*^9, 
   3.8997968038311157`*^9}, {3.9060508213433585`*^9, 
   3.9060508397809877`*^9}, {3.9071422918299685`*^9, 
   3.9071423700852394`*^9}, {3.9071424812190485`*^9, 3.907142510564954*^9}, {
   3.907142585319785*^9, 3.9071426310756598`*^9}, {3.9151025047585974`*^9, 
   3.9151025778461523`*^9}, 3.9275569709383554`*^9, {3.927725639332267*^9, 
   3.927725647302061*^9}, 3.9277268874770055`*^9},
 CellLabel->
  "In[321]:=",ExpressionUUID->"5dd480a7-9bca-408d-a303-24860a5e2a8d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "<>", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"subFolder", ",", "$PathnameSeparator"}], "]"}], "<>", 
      "\"\<_OG_mean_min_stdev_projections.jpg\>\""}], ",", 
     "\[IndentingNewLine]", "plotImageForms", ",", 
     RowBox[{"CompressionLevel", "\[Rule]", "0"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{"{", 
     RowBox[{"imageStack", ",", "checkupIDs"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.896437205370595*^9, 3.8964372099179287`*^9}, {
  3.9278882957210326`*^9, 3.927888297487585*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"618dcf84-9348-40fc-ae54-deccf99e2127"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particle Motion Check", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
  3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
  3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
  3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
  3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
  3.888486151680708*^9}, {3.927728901913908*^9, 3.9277289054972305`*^9}, {
  3.927741723681349*^9, 3.9277417290182457`*^9}},
 FontSize->24,ExpressionUUID->"92f15eaf-a101-403e-91cc-cc4d39fd36a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"motionCheckSingleImage", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "^", 
        RowBox[{"(", 
         RowBox[{"5", "/", "2"}], ")"}]}], "&"}], "@", 
      RowBox[{"ColorToneMapping", "@", 
       RowBox[{"HistogramTransform", "@", 
        RowBox[{"First", "@", "croppedImages"}]}]}]}], "//", 
     "rotateImage"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"motionCheckImageStack", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ColorToneMapping", "@", "#"}], "^", 
       RowBox[{"(", 
        RowBox[{"5", "/", "2"}], ")"}]}], "&"}], "@", 
     RowBox[{"ColorToneMapping", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Last", "@", "#"}], "/", 
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "&"}], "@", "imageForms"}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotMotionCheck", "=", 
  RowBox[{"GraphicsColumn", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"motionCheckSingleImage", ",", "motionCheckImageStack"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
    RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
    RowBox[{"Spacings", "\[Rule]", 
     RowBox[{"Scaled", "@", "0.025"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.927741742428795*^9, 3.9277418419840775`*^9}, {
  3.9277419381797857`*^9, 3.9277420214570036`*^9}, {3.927742160994214*^9, 
  3.927742188457799*^9}, {3.9278769883187966`*^9, 3.927877014230466*^9}, {
  3.9278771011031094`*^9, 3.9278771428001127`*^9}, {3.92789452889354*^9, 
  3.9278945300731936`*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"30ba6f68-d213-4e5e-a796-e52afca196a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", 
     RowBox[{"StringDelete", "[", 
      RowBox[{"subFolder", ",", "$PathnameSeparator"}], "]"}], "<>", 
     "\"\<_motion_check.jpg\>\""}], ",", "plotMotionCheck", ",", 
    RowBox[{"CompressionLevel", "\[Rule]", "0"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.927741742428795*^9, 3.9277419185373096`*^9}, {
  3.9277420583143606`*^9, 3.9277421424728317`*^9}, {3.927877152151228*^9, 
  3.9278771568628693`*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"b96a810a-d871-4055-a0ab-a06d53681d72"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Image Correction (Optional)", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.900053597447477*^9, 
   3.9000535978873005`*^9}, {3.9276028915190444`*^9, 3.9276028933908052`*^9}},
 FontSize->24,ExpressionUUID->"3ac51f76-07b5-4bd6-9a88-7ef3ccaa09d1"],

Cell["\<\
Defaults :
   
useCTMcorrection=0;   <<   0 or 1
meanCorrectionInvervals={1;;All};
useFlatCorrection=0;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, {3.905446106002844*^9, 3.9054461063221574`*^9}, 
   3.912238906748783*^9, 3.912247697133684*^9, {3.9122477658867474`*^9, 
   3.9122477785803137`*^9}, 3.9152128103077116`*^9, {3.9273077945637145`*^9, 
   3.927307797830636*^9}, {3.9273104799980865`*^9, 3.927310482909319*^9}, 
   3.927726969738305*^9, 3.927877759543066*^9},
 FontSize->16,ExpressionUUID->"9c07c24f-33b4-4628-a0ee-b2e176009d32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"useCTMcorrection", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanCorrectionInvervals", "=", 
   RowBox[{"{", 
    RowBox[{"1", ";;", "All"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"useFlatCorrection", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "meanCorrectionInvervals"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.901009787504681*^9, 3.9010097917100735`*^9}, 
   3.901017960267641*^9, {3.901034176749588*^9, 3.9010341768454943`*^9}, 
   3.9011050676796865`*^9, {3.9011068285285273`*^9, 3.901106843624278*^9}, 
   3.9011082033089123`*^9, 3.901108372307288*^9, 3.901109217600709*^9, {
   3.9011763293879924`*^9, 3.9011763297396183`*^9}, 3.9011766405011177`*^9, 
   3.9011774997351437`*^9, 3.90117854367038*^9, 3.901183912748456*^9, 
   3.9011841207396836`*^9, 3.903852673816848*^9, {3.9038745768439617`*^9, 
   3.9038745770329046`*^9}, 3.90387471324263*^9, {3.905445481871092*^9, 
   3.905445492025133*^9}, {3.9054456303064594`*^9, 3.9054456480482044`*^9}, {
   3.9054461127594285`*^9, 3.905446113009146*^9}, {3.9054461870229206`*^9, 
   3.9054461973750253`*^9}, {3.9054462299201355`*^9, 3.905446246857829*^9}, {
   3.905446365838926*^9, 3.9054463675750422`*^9}, 3.905446433024422*^9, {
   3.905449949081295*^9, 3.9054499593640423`*^9}, 3.905450643585202*^9, 
   3.9054520770789537`*^9, {3.90545264245087*^9, 3.9054526473983707`*^9}, {
   3.9054533073607955`*^9, 3.9054533269020557`*^9}, {3.9054533700507135`*^9, 
   3.9054533719655743`*^9}, 3.9054534907671537`*^9, 3.905454250495185*^9, {
   3.9054544769139967`*^9, 3.905454478516764*^9}, {3.9054545727920027`*^9, 
   3.9054545746383953`*^9}, {3.9054548299353004`*^9, 3.905454840717119*^9}, {
   3.9054550290800695`*^9, 3.9054550305729957`*^9}, 3.905455104470749*^9, 
   3.9054551585516367`*^9, {3.9054551951292863`*^9, 3.9054551971089716`*^9}, {
   3.905455256249323*^9, 3.905455256687652*^9}, 3.9122389005751343`*^9, {
   3.9122477052292285`*^9, 3.9122477481488*^9}, {3.91521249605107*^9, 
   3.915212500442044*^9}, {3.91521270093182*^9, 3.9152127040776834`*^9}, 
   3.915212816215397*^9, {3.9273077786815367`*^9, 3.927307791304179*^9}, 
   3.927391896344944*^9, {3.927391940609065*^9, 3.9273919431032314`*^9}, {
   3.92739252623242*^9, 3.9273925587910137`*^9}, {3.9273925932074995`*^9, 
   3.927392609503331*^9}, {3.927392639863887*^9, 3.9273926634871087`*^9}, {
   3.9274372442329435`*^9, 3.9274372492707396`*^9}, 3.927437470455326*^9, {
   3.9275158337924075`*^9, 3.9275158351920075`*^9}, {3.9275160191938877`*^9, 
   3.927516044038872*^9}, 3.9275161219787426`*^9, {3.9275372799409065`*^9, 
   3.927537284763134*^9}, {3.9275377280198774`*^9, 3.927537735578683*^9}, 
   3.927544336012204*^9, {3.927546890832822*^9, 3.9275468914491744`*^9}, 
   3.92754748549782*^9, 3.9275475159625072`*^9, 3.927609814855378*^9, {
   3.9276114636612034`*^9, 3.9276114806286907`*^9}, {3.927726963435966*^9, 
   3.927726965611043*^9}, {3.9277453561022825`*^9, 3.9277453638705297`*^9}, 
   3.9278578249966755`*^9, 3.927857931979583*^9, {3.927871519651908*^9, 
   3.9278715292714243`*^9}, {3.927877415438715*^9, 3.9278774243425016`*^9}, 
   3.9278895141602945`*^9, {3.930584618612989*^9, 3.9305846293872676`*^9}, {
   3.930588007050319*^9, 3.9305880076489735`*^9}, {3.9305880679546304`*^9, 
   3.9305880684726577`*^9}},
 CellLabel->
  "In[330]:=",ExpressionUUID->"24cdcf28-37c7-494f-a812-320be3d4af8c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"meanImages", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Mean", "@", 
       RowBox[{"croppedImages", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
     "meanCorrectionInvervals"}]}], ";"}], "//", "AbsoluteTiming"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"imagesCorrected", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"monitorCounter", "++"}], ";", 
              RowBox[{
               RowBox[{
                RowBox[{"Nest", "[", 
                 RowBox[{
                 "ColorToneMapping", ",", "#", ",", "useCTMprojections"}], 
                 "]"}], "&"}], "@", 
               RowBox[{"ColorNegate", "@", 
                RowBox[{
                 RowBox[{"If", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"useFlatCorrection", "\[Equal]", "1"}], ",", 
                   "meanCorrectionFlat", ",", "meanCorrection"}], 
                  "\[IndentingNewLine]", "]"}], "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ColorNegate", "@", "#"}], ",", 
                  RowBox[{"meanImages", "[", 
                   RowBox[{"[", "interval", "]"}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}]}]}]}], ")"}], "&"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"croppedImages", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
            RowBox[{"meanCorrectionInvervals", "[", 
             RowBox[{"[", "interval", "]"}], "]"}]}]}], "\[IndentingNewLine]",
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"interval", ",", "1", ",", 
           RowBox[{"Length", "@", "meanCorrectionInvervals"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", 
       RowBox[{"Flatten", "@", "croppedImages"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.901006633221992*^9, 3.901006667139427*^9}, {
   3.901006864591977*^9, 3.901006870859763*^9}, {3.901008471516359*^9, 
   3.9010084730918007`*^9}, 3.901009766814474*^9, {3.9010111873060517`*^9, 
   3.901011224222026*^9}, {3.901014409537009*^9, 3.901014412680328*^9}, {
   3.9011086035778236`*^9, 3.901108604234493*^9}, {3.9054461559104557`*^9, 
   3.9054461771848984`*^9}, {3.9054499547822285`*^9, 3.905449957984293*^9}, {
   3.9054546046945686`*^9, 3.905454605965007*^9}, {3.9054549303040867`*^9, 
   3.905454930734278*^9}, {3.9054564160961485`*^9, 3.9054564637111464`*^9}, {
   3.9072197883281517`*^9, 3.9072198549221554`*^9}, 3.9122475620653467`*^9, {
   3.9122478036057906`*^9, 3.912247816980792*^9}, {3.9122478601644373`*^9, 
   3.912247923046756*^9}, {3.9122484416896076`*^9, 3.9122484443174477`*^9}, {
   3.9123512515235133`*^9, 3.9123512521095085`*^9}, {3.91251906693609*^9, 
   3.9125190707055173`*^9}, {3.912519822664545*^9, 3.9125199049494123`*^9}, {
   3.9125199410200586`*^9, 3.9125199416566133`*^9}, {3.9126115412749686`*^9, 
   3.9126115422871323`*^9}, {3.912678879162035*^9, 3.91267888012951*^9}, {
   3.9152121691083593`*^9, 3.9152121744804106`*^9}, {3.9152123568371325`*^9, 
   3.915212371574143*^9}, {3.9152125057911596`*^9, 3.915212514924588*^9}, {
   3.9152125620130444`*^9, 3.9152126306145363`*^9}, {3.915212855269752*^9, 
   3.91521285633385*^9}, {3.9152129870797415`*^9, 3.915212991917593*^9}, {
   3.9152190041469245`*^9, 3.9152190051644325`*^9}, {3.9156236747984447`*^9, 
   3.915623701430708*^9}, 3.915623733855213*^9, {3.9273078157765822`*^9, 
   3.927307845062628*^9}, {3.92754738116288*^9, 3.927547383486621*^9}, {
   3.927547426578492*^9, 3.9275474269135475`*^9}, {3.9275474660344725`*^9, 
   3.927547468648484*^9}, {3.9276025477529535`*^9, 3.927602548876901*^9}, {
   3.9276026349526796`*^9, 3.927602640079999*^9}, {3.927602715729109*^9, 
   3.9276027183674245`*^9}, {3.9276028343125534`*^9, 
   3.9276028406867633`*^9}, {3.9276114298454504`*^9, 3.92761143107259*^9}, 
   3.9276114610845423`*^9, {3.92761152557992*^9, 3.9276115271074452`*^9}, {
   3.9277269751577873`*^9, 3.9277269895820217`*^9}, {3.9277270404372616`*^9, 
   3.9277270414278755`*^9}, {3.92772769390904*^9, 3.9277277004354625`*^9}, 
   3.9277287156579437`*^9, {3.9277307982814713`*^9, 3.9277308073440237`*^9}, {
   3.927857845027771*^9, 3.9278578481780586`*^9}, {3.9278579044286566`*^9, 
   3.92785791908981*^9}, {3.9278774002170877`*^9, 3.9278774608220987`*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"be06836d-a594-4699-9bfc-98b6d95782b5"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"viewImage", "@", 
    RowBox[{"rotateImage", "@", 
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"imagesCorrected", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "imagesCorrected"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.915213341325284*^9, 3.9152133687807274`*^9}, {
   3.9152199805850906`*^9, 3.915219981061466*^9}, 3.915647315959836*^9, {
   3.917042369955835*^9, 3.917042372182444*^9}, {3.9273076935119314`*^9, 
   3.927307695646968*^9}, {3.927307736482185*^9, 3.9273077366154385`*^9}, {
   3.9275474427779016`*^9, 3.927547459338092*^9}, {3.9275475249944296`*^9, 
   3.92754754036942*^9}, {3.9276029218884788`*^9, 3.9276029234473057`*^9}, 
   3.9276115597946224`*^9},
 CellLabel->
  "In[337]:=",ExpressionUUID->"31c26922-8cad-4617-a5de-3cde4d9dc6d1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particle CNR Boost & Detection", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 3.8468307830344753`*^9}, {3.8852951251696224`*^9, 
  3.885295127082173*^9}, {3.889042301650259*^9, 3.8890423160585136`*^9}, {
  3.8890423778257504`*^9, 3.889042384505704*^9}, {3.9059693428318996`*^9, 
  3.905969344494928*^9}, {3.927726812003014*^9, 
  3.927726815762393*^9}},ExpressionUUID->"a4feb96b-f813-4ed0-9703-\
152c70302f67"],

Cell[CellGroupData[{

Cell["Segment Channel Boundaries", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.9276423635857763`*^9, 
   3.9276423658274627`*^9}, {3.927726806915962*^9, 3.927726808723959*^9}, {
   3.927727091049946*^9, 3.927727092297619*^9}, {3.927862463239792*^9, 
   3.927862472128414*^9}},
 FontSize->24,ExpressionUUID->"a3fac260-2ed5-4503-8004-b720b157dff1"],

Cell["\<\
Things to adjust if necessary:

\[OpenCurlyQuote]luminanceCompression\[CloseCurlyQuote] -- for initial \
boundary segmentation
\[OpenCurlyQuote]dilationScale\[CloseCurlyQuote] -- controls the \
boundary-conformal cutoff buffer for artifact mitigation
\[OpenCurlyQuote]adaptiveBinarizeScaleFactor\[CloseCurlyQuote] -- for \
smoother (straighter) or finer-detailed boundary
\[OpenCurlyQuote]openingSmoothingScale\[CloseCurlyQuote] -- for smoother \
(straighter) or finer-detailed boundary

\[OpenCurlyQuote]detectChannelWalls\[CloseCurlyQuote] -- set to 0 if the \
entire FOV is relevant, otherwise set to 1 to detect channel walls and create \
buffers\
\>", "Abstract",
 CellChangeTimes->{{3.888922906196766*^9, 3.8889229194346066`*^9}, {
  3.894804961323394*^9, 3.894804965269334*^9}, {3.930291325113571*^9, 
  3.9302913434852905`*^9}, {3.9306338576574726`*^9, 3.930634049619918*^9}, {
  3.9306340896974316`*^9, 3.9306340918488035`*^9}, {3.9306346891844635`*^9, 
  3.9306347014882107`*^9}, {3.9306347404003754`*^9, 3.9306348346963153`*^9}, {
  3.930665441149001*^9, 3.930665504492344*^9}, {3.9307366420125966`*^9, 
  3.9307366864072714`*^9}},
 FontSize->18,ExpressionUUID->"d17ca023-bef5-4aac-9f61-adbe1ff0ebfd"],

Cell["\<\
Defaults :
   
detectChannelWalls=0;  << 0 or 1

luminanceCompression=0.5;
adaptiveBinarizeScaleFactor=0.75;
gaussianScale=2;
closingScale=5;
openingSmoothingScale=50;
dilationScale=10;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, {3.905446106002844*^9, 3.9054461063221574`*^9}, 
   3.912238906748783*^9, 3.912247697133684*^9, {3.9122477658867474`*^9, 
   3.9122477785803137`*^9}, 3.9152128103077116`*^9, {3.9273077945637145`*^9, 
   3.927307797830636*^9}, {3.9273104799980865`*^9, 3.927310482909319*^9}, 
   3.927726969738305*^9, 3.9278624845942726`*^9, 3.927862712921297*^9, {
   3.9278782318946786`*^9, 3.927878246751482*^9}, 3.9307366952532797`*^9},
 FontSize->16,ExpressionUUID->"eba4f223-c78c-4207-a181-fd2801ca4e7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"detectChannelWalls", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"luminanceCompression", "=", "0.4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"adaptiveBinarizeScaleFactor", "=", "0.85"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gaussianScale", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"closingScale", "=", "5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"openingSmoothingScale", "=", "150"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dilationScale", "=", "25"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.927861166427828*^9, 3.9278611771570363`*^9}, {
   3.927861265554002*^9, 3.9278612734266806`*^9}, {3.927862230281167*^9, 
   3.9278622657781715`*^9}, {3.927862315944974*^9, 3.92786236389756*^9}, {
   3.9278626230973716`*^9, 3.9278626354760675`*^9}, {3.9278627108510337`*^9, 
   3.9278627109448705`*^9}, {3.927862856648898*^9, 3.927862903464348*^9}, 
   3.927875117160406*^9, {3.927878208702079*^9, 3.9278782216725063`*^9}, {
   3.9278895518707156`*^9, 3.927889562224919*^9}, {3.927891872576355*^9, 
   3.92789187274886*^9}, {3.927892005492653*^9, 3.927892016436519*^9}, 
   3.927892152948902*^9, {3.927893740885126*^9, 3.9278937409387064`*^9}, {
   3.927893772541628*^9, 3.927893772730737*^9}, {3.9278944157951193`*^9, 
   3.9278944158673697`*^9}, {3.9278944484603395`*^9, 
   3.9278944706664104`*^9}, {3.927894501909528*^9, 3.9278945038669987`*^9}, {
   3.928564731753087*^9, 3.928564750752685*^9}, {3.9303849764891644`*^9, 
   3.9303849765682535`*^9}, {3.930385009520872*^9, 3.930385010516574*^9}, {
   3.930390999887209*^9, 3.930391002492567*^9}, {3.930393134590678*^9, 
   3.930393134674145*^9}, {3.9303934678541756`*^9, 3.9303934685625*^9}, {
   3.9304071800115767`*^9, 3.9304071802978077`*^9}, {3.9304072242165675`*^9, 
   3.9304072244974546`*^9}, {3.930540341954933*^9, 3.9305403682331915`*^9}, {
   3.9305846401406393`*^9, 3.930584762265855*^9}, {3.9305849139740725`*^9, 
   3.9305849482112913`*^9}, {3.9305850629179897`*^9, 3.930585064651246*^9}, 
   3.930585380490881*^9, {3.930585416795624*^9, 3.930585431787305*^9}, {
   3.930585486395131*^9, 3.9305855022666864`*^9}, {3.93058578269013*^9, 
   3.930585786420898*^9}, {3.9305859044903708`*^9, 3.93058595986543*^9}, {
   3.9305873216735134`*^9, 3.9305873415790353`*^9}, {3.9305880271539984`*^9, 
   3.9305880297361903`*^9}, 3.9305900671924076`*^9, {3.9305901386235027`*^9, 
   3.9305901657537117`*^9}, {3.9305902851127663`*^9, 3.930590308415064*^9}, {
   3.9305911068627386`*^9, 3.9305911070617094`*^9}, {3.930632837498704*^9, 
   3.9306328386178226`*^9}, {3.9306383687441015`*^9, 3.930638370463443*^9}, {
   3.9306384293590455`*^9, 3.9306384294709067`*^9}, {3.9306384962882056`*^9, 
   3.9306384964578395`*^9}, 
   3.930736705303516*^9},ExpressionUUID->"a68eba93-21c3-4254-b9f6-\
4963fc58d6e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"channelWallMask", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"detectChannelWalls", "\[Equal]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"channelWallMask", "=", 
         RowBox[{"getChannelWallMask", "@", "#"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"channelWallMask", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Binarize", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
          RowBox[{"ImageRotate", "[", 
           RowBox[{"#", ",", 
            RowBox[{"-", "rotationAngle"}]}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], "@", 
     RowBox[{"imageForms", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotChannelWalls", "=", 
   RowBox[{"GraphicsColumn", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"ImageRotate", "[", 
            RowBox[{"#", ",", "rotationAngle"}], "]"}], "&"}], "@", 
          "channelWallMask"}], ",", "Red", ",", "2"}], "\[IndentingNewLine]", 
        "]"}], "&"}], "/@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"imageForms", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"preprocessImageInverted", "@", 
         RowBox[{"rotateImage", "@", 
          RowBox[{"First", "@", "imagesCorrected"}]}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
     RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"Scaled", "@", "0.025"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"channelWallMaskPhysical", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Erosion", "[", 
       RowBox[{"#", ",", 
        RowBox[{"DiskMatrix", "@", "dilationScale"}]}], "]"}], "&"}], "@", 
     "channelWallMask"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotChannelWallsPhysical", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"imageForms", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"rotateImage", "@", "#"}], ",", "Red", ",", "2"}], 
       "\[IndentingNewLine]", "]"}], "&"}], "@", 
     "channelWallMaskPhysical"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"viewImage", "@", 
    RowBox[{"getMaskOverlays", "[", 
     RowBox[{"#", ",", 
      RowBox[{"rotateImage", "@", "channelWallMask"}], ",", "Yellow", ",", 
      "2"}], "]"}]}], "&"}], "@", "plotChannelWallsPhysical"}]}], "Input",
 CellChangeTimes->{{3.927860206624527*^9, 3.927860412586644*^9}, {
   3.92786046993489*^9, 3.927860638129953*^9}, {3.92786069523552*^9, 
   3.9278607174287376`*^9}, {3.9278608539649363`*^9, 
   3.9278610139940453`*^9}, {3.9278610594193926`*^9, 
   3.9278612007475324`*^9}, {3.927861267435095*^9, 3.927861294698106*^9}, 
   3.927861625585044*^9, {3.9278616559748063`*^9, 3.927861740273142*^9}, {
   3.9278617758830724`*^9, 3.9278617760886607`*^9}, {3.9278622362511063`*^9, 
   3.9278622396257725`*^9}, 3.927862323906496*^9, {3.927862369666856*^9, 
   3.927862377966502*^9}, {3.927862499011532*^9, 3.927862552282482*^9}, {
   3.9278626008504906`*^9, 3.9278626159444084`*^9}, {3.927862652186276*^9, 
   3.9278626820435514`*^9}, {3.927862731833774*^9, 3.9278628268685074`*^9}, {
   3.927869760341883*^9, 3.9278699116915216`*^9}, 3.9278713364261837`*^9, 
   3.9278715427882547`*^9, {3.9278740401554127`*^9, 3.9278740574660454`*^9}, 
   3.927875758693701*^9, {3.9278758729870663`*^9, 3.9278758907809486`*^9}, {
   3.9278759917022543`*^9, 3.927876005307213*^9}, {3.927876535703968*^9, 
   3.9278765563110456`*^9}, {3.9278778186631002`*^9, 3.927877832050149*^9}, {
   3.927878251460349*^9, 3.927878273966511*^9}, {3.9278896639770794`*^9, 
   3.9278897449838967`*^9}, 3.927891883555201*^9, {3.927894517364936*^9, 
   3.92789451880159*^9}, {3.9285533703704224`*^9, 3.9285533715667753`*^9}, {
   3.928559503885193*^9, 3.928559612907301*^9}, {3.9305846910051556`*^9, 
   3.9305846937711616`*^9}, {3.930585719631452*^9, 3.9305857808524528`*^9}, {
   3.930590194327792*^9, 3.9305902595590177`*^9}, {3.9305902949284906`*^9, 
   3.9305902957114525`*^9}, {3.9306655598634634`*^9, 3.9306655683445315`*^9}},
 CellLabel->
  "In[344]:=",ExpressionUUID->"da6d1574-3c17-44c8-8cfa-ec0bd93f9f2b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Channel Wall Mask >>", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.9276423635857763`*^9, 
   3.9276423658274627`*^9}, {3.927726806915962*^9, 3.927726808723959*^9}, {
   3.927727091049946*^9, 3.927727092297619*^9}, {3.927862463239792*^9, 
   3.927862472128414*^9}, {3.9278779815337753`*^9, 3.9278779925050073`*^9}, {
   3.9306660441914005`*^9, 3.9306660513889337`*^9}},
 FontSize->24,ExpressionUUID->"652f9cac-fbc4-4212-a647-86c11a64a361"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"output", "<>", 
        RowBox[{"StringDelete", "[", 
         RowBox[{"subFolder", ",", "$PathnameSeparator"}], "]"}], "<>", 
        "\"\<_channel_walls_mask_\>\"", "<>", "#1"}], ",", "#2", ",", 
       RowBox[{"CompressionLevel", "\[Rule]", "0"}]}], "]"}], "&"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<.jpg\>\"", ",", "\"\<physical.jpg\>\"", ",", "\"\<binary.png\>\"",
         ",", "\"\<binary_physical.png\>\""}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "plotChannelWalls", ",", "plotChannelWallsPhysical", ",", 
        "channelWallMask", ",", "channelWallMaskPhysical"}], "}"}]}], 
     "\[IndentingNewLine]", "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9306659070649595`*^9, 3.930666036029704*^9}, {
  3.930666140716614*^9, 3.930666142139807*^9}},
 CellLabel->
  "In[349]:=",ExpressionUUID->"982d9c6c-e2fc-4d32-bced-d9a15f201654"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ Test Filter Output ]]", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}, {3.9276423635857763`*^9, 
   3.9276423658274627`*^9}, {3.927726806915962*^9, 3.927726808723959*^9}, {
   3.927727091049946*^9, 3.927727092297619*^9}},
 FontSize->24,ExpressionUUID->"d3e4c591-b0d4-40e6-834d-4ebca51b6842"],

Cell["\<\
Things to adjust if necessary:

preprocessPassesSecondary -- usually anywhere between 10 an 20
Default: 15; for 8 flow rates, might want 20
For cases with channel walls outside the FOV, can set to 0\
\>", "Abstract",
 CellChangeTimes->{{3.888922906196766*^9, 3.8889229194346066`*^9}, {
  3.894804961323394*^9, 3.894804965269334*^9}, {3.930291325113571*^9, 
  3.9302913434852905`*^9}, {3.9306338576574726`*^9, 3.930634049619918*^9}, {
  3.9306340896974316`*^9, 3.9306340918488035`*^9}, {3.9306346891844635`*^9, 
  3.9306347014882107`*^9}, {3.9306347404003754`*^9, 3.9306348346963153`*^9}, {
  3.9306349644578176`*^9, 3.930634999131501*^9}, {3.9306682322352047`*^9, 
  3.930668246435502*^9}},
 FontSize->18,ExpressionUUID->"1277bdf1-5777-40ac-97a0-cf1746ced3bd"],

Cell["\<\
Defaults :
   
preprocessPassesPrimary=2;
useCTMprimary=0;

nonlocalCorrectionRadius=2;
nonlocalNoiseFactor=1;
nonlocalCorrectionWeight=1.75;

peronaMalikConductivity=0.1;
peronaMalikIterations=2;

preprocessPassesSecondary=15;
{sizeMinimum,sizeMaximum}={5,50};\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, {3.905446106002844*^9, 3.9054461063221574`*^9}, 
   3.912238906748783*^9, 3.912247697133684*^9, {3.9122477658867474`*^9, 
   3.9122477785803137`*^9}, 3.9152128103077116`*^9, {3.9273077945637145`*^9, 
   3.927307797830636*^9}, {3.9273104799980865`*^9, 3.927310482909319*^9}, 
   3.927726969738305*^9, 3.927727283363947*^9, 3.92774347100113*^9, {
   3.9277860683163767`*^9, 3.9277860687723646`*^9}, {3.9306656146278877`*^9, 
   3.9306656148922987`*^9}},
 FontSize->16,ExpressionUUID->"3595dfbb-7a52-446b-ae63-d69855757ebc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"preprocessPassesPrimary", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"useCTMprimary", "=", "0"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonlocalCorrectionRadius", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalNoiseFactor", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nonlocalCorrectionWeight", "=", "1.75"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"peronaMalikConductivity", "=", "0.1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"peronaMalikIterations", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"preprocessPassesSecondary", "=", "15"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sizeMinimum", ",", "sizeMaximum"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "20"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9277212862302675`*^9, 3.927721293486743*^9}, 
   3.9277238506375084`*^9, {3.9277246871907387`*^9, 3.927724688588443*^9}, {
   3.9277251800592175`*^9, 3.9277251948129745`*^9}, {3.9277252564686093`*^9, 
   3.9277252706011286`*^9}, {3.9277254020175505`*^9, 3.927725466411992*^9}, {
   3.9277255757324963`*^9, 3.9277255782754803`*^9}, {3.927725909845315*^9, 
   3.9277259243768883`*^9}, 3.927725955419095*^9, 3.9277261114446807`*^9, 
   3.9277262224529867`*^9, {3.927726464428007*^9, 3.927726477202383*^9}, {
   3.9277290590586357`*^9, 3.927729059960866*^9}, 3.927729557178412*^9, 
   3.9277422586667414`*^9, {3.927742297449136*^9, 3.927742317088294*^9}, {
   3.927742391818864*^9, 3.9277424184989805`*^9}, {3.927742574937298*^9, 
   3.9277425751207304`*^9}, 3.9277426222886653`*^9, 3.9277426579198*^9, {
   3.9277427067286973`*^9, 3.9277427095770154`*^9}, 3.9277427524816694`*^9, {
   3.9277427905765953`*^9, 3.927742800791606*^9}, 3.9277428418980665`*^9, 
   3.9277433026718397`*^9, {3.927743332776534*^9, 3.9277434354655657`*^9}, {
   3.92774347703959*^9, 3.927743484081076*^9}, {3.92774351836062*^9, 
   3.927743536856537*^9}, {3.927743631567196*^9, 3.927743653498296*^9}, {
   3.9277436977961407`*^9, 3.927743721385311*^9}, 3.92774513402544*^9, 
   3.9277452210546923`*^9, {3.9277786380848417`*^9, 3.9277786456579905`*^9}, {
   3.9277856810814176`*^9, 3.9277856833813505`*^9}, 3.9277860665097437`*^9, {
   3.9277911081858807`*^9, 3.9277911090820117`*^9}, {3.9277957992941165`*^9, 
   3.9277958190693274`*^9}, 3.927795864533791*^9, {3.927796176678743*^9, 
   3.9277961833971834`*^9}, {3.9277970626861315`*^9, 
   3.9277970633477807`*^9}, {3.927797172396741*^9, 3.927797180301424*^9}, {
   3.927798248964364*^9, 3.927798284523144*^9}, {3.9277983209801774`*^9, 
   3.927798334124131*^9}, {3.9277984303877864`*^9, 3.9277984797013054`*^9}, 
   3.927798512811514*^9, {3.927798748364295*^9, 3.927798798524929*^9}, {
   3.927798837605035*^9, 3.9277988386593876`*^9}, {3.9277988755170193`*^9, 
   3.927798879099697*^9}, 3.927798922004876*^9, {3.927798964716169*^9, 
   3.927799013958662*^9}, {3.927799068499776*^9, 3.9277990685626755`*^9}, {
   3.927799489263538*^9, 3.92779954563562*^9}, {3.9277995926435757`*^9, 
   3.927799592730523*^9}, {3.927799639028174*^9, 3.927799639786725*^9}, {
   3.9277999212677784`*^9, 3.9277999213239408`*^9}, {3.9278000164201174`*^9, 
   3.9278000168345532`*^9}, {3.9278000473960257`*^9, 
   3.9278000476128235`*^9}, {3.9278000932220745`*^9, 
   3.9278001060111904`*^9}, {3.927800142787883*^9, 3.927800168725519*^9}, {
   3.927800214765658*^9, 3.9278003419544*^9}, {3.9278161472162175`*^9, 
   3.9278161596966934`*^9}, {3.9278162106056504`*^9, 3.927816211271033*^9}, {
   3.9278579670843487`*^9, 3.9278580076463995`*^9}, {3.927862936569189*^9, 
   3.9278629472088833`*^9}, {3.9278630407285247`*^9, 
   3.9278630613366003`*^9}, {3.927869148868503*^9, 3.927869178896023*^9}, 
   3.927870087148783*^9, 3.927870121083666*^9, 3.9278712451571813`*^9, 
   3.9278715509070225`*^9, {3.927872271371147*^9, 3.9278723022489824`*^9}, {
   3.9278724386209736`*^9, 3.927872449060035*^9}, {3.927874109875023*^9, 
   3.927874131779685*^9}, {3.9278742150846567`*^9, 3.927874225981089*^9}, {
   3.9278744028410215`*^9, 3.9278744268262463`*^9}, 3.927874634658757*^9, 
   3.9278747163935823`*^9, {3.9278751445307035`*^9, 3.9278751562692037`*^9}, {
   3.927875294769125*^9, 3.927875294935853*^9}, 3.9278753324164486`*^9, {
   3.9278753684492044`*^9, 3.9278753685111027`*^9}, {3.92787580341742*^9, 
   3.9278758084473343`*^9}, {3.9278760475046306`*^9, 3.927876057959247*^9}, 
   3.927876117002718*^9, {3.927876200409174*^9, 3.927876200659707*^9}, {
   3.9278765732964745`*^9, 3.9278765890396566`*^9}, {3.9278772842549176`*^9, 
   3.927877307975379*^9}, {3.927885758550297*^9, 3.927885766296459*^9}, 
   3.9278898340339127`*^9, {3.9278909591025305`*^9, 3.9278909714244413`*^9}, {
   3.927891414197485*^9, 3.92789142604554*^9}, {3.927891561776001*^9, 
   3.9278915781112432`*^9}, {3.927891904799521*^9, 3.9278919094611635`*^9}, 
   3.9278920336942515`*^9, 3.927892146652931*^9, {3.9278922579670362`*^9, 
   3.9278922712919416`*^9}, {3.927892393654908*^9, 3.927892396109917*^9}, {
   3.9278925446785383`*^9, 3.927892578893627*^9}, {3.9278926978204803`*^9, 
   3.9278926987242813`*^9}, {3.927892837973612*^9, 3.9278928425077143`*^9}, {
   3.927892935384884*^9, 3.927892936899209*^9}, {3.927893532316484*^9, 
   3.927893532383147*^9}, {3.9278946016145506`*^9, 3.9278946265628557`*^9}, {
   3.92789516974681*^9, 3.9278951722589355`*^9}, {3.9278954094831257`*^9, 
   3.9278954137469287`*^9}, {3.927895476068596*^9, 3.9278955327387753`*^9}, {
   3.9278959574354863`*^9, 3.927895965426727*^9}, {3.9278965456991806`*^9, 
   3.9278965458760056`*^9}, {3.9303915833891172`*^9, 3.930391630389329*^9}, 
   3.9303922734475374`*^9, {3.930392401595993*^9, 3.930392401696083*^9}, {
   3.930392714815172*^9, 3.930392715097574*^9}, {3.930407163868158*^9, 
   3.9304071673927126`*^9}, {3.9304081761229544`*^9, 3.9304082106647024`*^9}, 
   3.930540046041563*^9, 3.930540140017844*^9, {3.930540380458104*^9, 
   3.930540414289281*^9}, {3.9305404717937703`*^9, 3.9305404911452036`*^9}, {
   3.9305429329115195`*^9, 3.9305429467904434`*^9}, {3.9305431150021205`*^9, 
   3.9305431152147036`*^9}, {3.9305435812483873`*^9, 3.930543581318269*^9}, {
   3.930554522902665*^9, 3.9305545230661755`*^9}, {3.9305546418382883`*^9, 
   3.9305546425842695`*^9}, {3.9305661974055843`*^9, 
   3.9305662162876472`*^9}, {3.9305815447580843`*^9, 3.9305815448868732`*^9}, 
   3.9305860009073825`*^9, {3.9305874829227037`*^9, 3.9305875042744637`*^9}, 
   3.93058773411392*^9, 3.930588046051015*^9},
 CellLabel->
  "In[350]:=",ExpressionUUID->"6ff959a9-4e3a-42a8-b33c-cc8abb9cdc9a"],

Cell["\<\
Options :
   
testImages=croppedImages;
testImages=imagesCorrected;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.9007447255947275`*^9, 
   3.9010112144715767`*^9, {3.905446106002844*^9, 3.9054461063221574`*^9}, 
   3.912238906748783*^9, 3.912247697133684*^9, {3.9122477658867474`*^9, 
   3.9122477785803137`*^9}, 3.9152128103077116`*^9, {3.9273077945637145`*^9, 
   3.927307797830636*^9}, {3.9273104799980865`*^9, 3.927310482909319*^9}, 
   3.927726969738305*^9, 3.927727283363947*^9, {3.9277308468474426`*^9, 
   3.9277308660233183`*^9}, 3.9277407467291813`*^9},
 FontSize->16,ExpressionUUID->"4cced035-5b09-4a3d-91fd-217c18fe5360"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testID", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testImages", "=", "imagesCorrected"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stage0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"rotateImage", "@", 
       RowBox[{"ImageMultiply", "[", 
        RowBox[{
         RowBox[{"ColorNegate", "@", "channelWallMask"}], ",", "#"}], "]"}]}],
       "&"}], "@", 
     RowBox[{"testImages", "[", 
      RowBox[{"[", "testID", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stage1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Nest", "[", 
          RowBox[{"ColorToneMapping", ",", "#", ",", "useCTMprimary"}], "]"}],
          "&"}], "@", 
        RowBox[{"Nest", "[", "\[IndentingNewLine]", 
         RowBox[{
         "preprocessImageInverted", ",", "#", ",", 
          "preprocessPassesPrimary"}], "\[IndentingNewLine]", "]"}]}], "&"}], 
      "@", "stage0"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stage2", "=", 
     RowBox[{"applyNMM", "@", "stage1"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stage3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"PeronaMalikFilter", "[", "\[IndentingNewLine]", 
        RowBox[{
        "#", ",", "peronaMalikIterations", ",", "peronaMalikConductivity"}], 
        "\[IndentingNewLine]", "]"}], "&"}], "@", "stage2"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stage4", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Nest", "[", 
        RowBox[{
        "applyCTMinverted", ",", "#", ",", "preprocessPassesSecondary"}], 
        "]"}], "&"}], "@", "stage3"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stage5", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"SelectComponents", "[", "\[IndentingNewLine]", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"sizeMinimum", "<", "#Count", "<", "sizeMaximum"}], 
              "&"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
          RowBox[{"DeleteBorderComponents", "@", 
           RowBox[{"Binarize", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Method", "\[Rule]", "\"\<Entropy\>\""}]}], "]"}]}]}], 
         "&"}], "@", 
        RowBox[{"ImageMultiply", "[", 
         RowBox[{
          RowBox[{"rotateImage", "@", 
           RowBox[{"ColorNegate", "@", "channelWallMask"}]}], ",", "#"}], 
         "]"}]}], "&"}], "@", "stage4"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "stage0", ",", "stage1", ",", "stage2", ",", "stage3", ",", "stage4", 
      ",", "stage5"}], "\[IndentingNewLine]", "}"}]}], "//", 
   RowBox[{
    RowBox[{"GraphicsGrid", "[", 
     RowBox[{"#", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
      RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
      RowBox[{"Spacings", "\[Rule]", 
       RowBox[{"Scaled", "@", "0.025"}]}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"HighlightImage", "[", 
  RowBox[{"stage4", ",", 
   RowBox[{"ImageMarker", "[", 
    RowBox[{"stage5", ",", "\"\<Circle\>\""}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9071459374223423`*^9, 3.9071460421270714`*^9}, {
   3.9071461071335564`*^9, 3.9071461453552465`*^9}, {3.90714631603596*^9, 
   3.907146345166182*^9}, {3.907167082299802*^9, 3.907167110840786*^9}, {
   3.9071671712378955`*^9, 3.9071671746427517`*^9}, {3.907178167723169*^9, 
   3.9071781782900443`*^9}, {3.9071792584537125`*^9, 3.907179258523782*^9}, {
   3.9071792958835616`*^9, 3.907179295970462*^9}, {3.9071797936830006`*^9, 
   3.907179795258401*^9}, {3.9071806805794115`*^9, 3.90718068272302*^9}, {
   3.9151026133140173`*^9, 3.915102617578103*^9}, {3.9275570357025175`*^9, 
   3.9275570386069984`*^9}, {3.9276016903542633`*^9, 
   3.9276016927411137`*^9}, {3.927602488165476*^9, 3.927602489916798*^9}, {
   3.9276025983819895`*^9, 3.9276026021774645`*^9}, {3.9276026742243605`*^9, 
   3.9276026750202203`*^9}, {3.927602754168847*^9, 3.9276027698069706`*^9}, {
   3.9276029635448446`*^9, 3.927602964239606*^9}, 3.9276030285686617`*^9, {
   3.927603190719322*^9, 3.9276032678316884`*^9}, {3.927609731342975*^9, 
   3.9276097314709196`*^9}, {3.9276113424464364`*^9, 
   3.9276113540933075`*^9}, {3.9276423734276104`*^9, 3.927642384723716*^9}, {
   3.927721213031794*^9, 3.9277212583182573`*^9}, {3.927721296838828*^9, 
   3.927721428270521*^9}, {3.9277217616944356`*^9, 3.9277217623005824`*^9}, {
   3.927721850478438*^9, 3.9277218820383744`*^9}, 3.9277231297651024`*^9, {
   3.9277232641430397`*^9, 3.927723279457739*^9}, {3.9277234005044255`*^9, 
   3.927723409532337*^9}, {3.927723602997188*^9, 3.927723641821081*^9}, 
   3.9277236989214783`*^9, {3.9277237355585675`*^9, 3.9277237476643515`*^9}, {
   3.9277237863744974`*^9, 3.927723808318225*^9}, {3.9277239348171453`*^9, 
   3.927723956008339*^9}, {3.9277239916810837`*^9, 3.9277239922030954`*^9}, {
   3.9277240303415422`*^9, 3.9277240341663914`*^9}, 3.9277243667496676`*^9, {
   3.9277244865738506`*^9, 3.927724488202939*^9}, {3.927724535051787*^9, 
   3.9277245397161922`*^9}, {3.927724796502836*^9, 3.927724822680127*^9}, {
   3.9277249152260914`*^9, 3.9277249346680503`*^9}, {3.9277249813971243`*^9, 
   3.927724986113117*^9}, {3.9277250518298597`*^9, 3.927725079684371*^9}, {
   3.9277251109103794`*^9, 3.927725152356922*^9}, {3.9277251987663393`*^9, 
   3.927725345301221*^9}, {3.9277254726231585`*^9, 3.9277254917880025`*^9}, {
   3.9277255420912447`*^9, 3.927725561299162*^9}, {3.9277260719869766`*^9, 
   3.9277260849395003`*^9}, {3.927726149911436*^9, 3.927726151009857*^9}, {
   3.927726314003336*^9, 3.9277263293828306`*^9}, {3.9277264825981407`*^9, 
   3.9277265593540707`*^9}, {3.927726748500147*^9, 3.9277267740261374`*^9}, {
   3.9277274331596575`*^9, 3.927727443122208*^9}, {3.927727803516405*^9, 
   3.927727810129965*^9}, {3.9277280971029453`*^9, 3.9277281056206093`*^9}, {
   3.927728279291334*^9, 3.927728380378677*^9}, {3.927740737700377*^9, 
   3.9277407662657804`*^9}, {3.927742438683031*^9, 3.9277424412241726`*^9}, {
   3.9277424752310514`*^9, 3.9277424953680687`*^9}, {3.9277425472442217`*^9, 
   3.927742572144991*^9}, 3.927742629029648*^9, {3.927743105202082*^9, 
   3.927743106167963*^9}, {3.9277432676051874`*^9, 3.927743293955618*^9}, {
   3.9277815533716664`*^9, 3.927781556353157*^9}, {3.927785713832012*^9, 
   3.9277857239028854`*^9}, {3.927786099040168*^9, 3.9277861168384476`*^9}, {
   3.927795894231056*^9, 3.9277958959258347`*^9}, {3.9277962891435213`*^9, 
   3.9277962910943575`*^9}, 3.9277966815199003`*^9, 3.9277968743288794`*^9, {
   3.9277970446617146`*^9, 3.9277970768469696`*^9}, {3.9277971532385616`*^9, 
   3.927797167382529*^9}, 3.927798261614151*^9, {3.927798337445126*^9, 
   3.927798405560504*^9}, {3.9277984847735724`*^9, 3.9277984880302095`*^9}, {
   3.927798705863582*^9, 3.927798775114772*^9}, {3.9277988260367975`*^9, 
   3.9277988446728015`*^9}, {3.927798948284792*^9, 3.9277989503919897`*^9}, {
   3.927799646099979*^9, 3.927799662164744*^9}, {3.9278003554810023`*^9, 
   3.9278003584794135`*^9}, {3.927800705682863*^9, 3.9278007059066453`*^9}, {
   3.9278008143814077`*^9, 3.9278008175357704`*^9}, 3.927816285616274*^9, 
   3.9278581224697714`*^9, {3.9278615591301346`*^9, 3.9278615906174912`*^9}, 
   3.9278620815306797`*^9, 3.927862160033985*^9, 3.9278622100433617`*^9, {
   3.9278629784436703`*^9, 3.9278630026256156`*^9}, 3.92787002246988*^9, 
   3.9278701412128983`*^9, 3.9278712299675255`*^9, {3.927871359669784*^9, 
   3.9278713612894535`*^9}, {3.92787670009645*^9, 3.9278767010500374`*^9}, {
   3.927876852369566*^9, 3.9278768570503845`*^9}, {3.927877952329101*^9, 
   3.927877956417924*^9}, {3.9278859740543213`*^9, 3.9278859752574806`*^9}, {
   3.927895870677793*^9, 3.9278959034191275`*^9}, {3.9278959777015576`*^9, 
   3.9278959793079414`*^9}, {3.9278963666351357`*^9, 3.927896405940654*^9}, {
   3.9278964420846176`*^9, 3.927896465503867*^9}, {3.9278965252031326`*^9, 
   3.9278965511632805`*^9}},
 CellLabel->
  "In[359]:=",ExpressionUUID->"5b964cba-d1c3-4a96-b069-5d1586ad271e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Process Images", "Subsection",
 CellChangeTimes->{{3.8931423053858385`*^9, 3.8931423475374203`*^9}, 
   3.900090717393674*^9, {3.9059694860785613`*^9, 3.905969488834731*^9}, {
   3.9277268222215295`*^9, 3.9277268283859863`*^9}, {3.92789590893239*^9, 
   3.927895910114279*^9}},
 FontSize->24,ExpressionUUID->"5ddb74a0-d46e-474d-9a1a-9fc13d2d2c29"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"imagesFiltered", "=", 
       RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"globalFiltering", "@", "#"}]}], ")"}], "&"}], ",", 
         "testImages"}], "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "testImages"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"particleMasks", "=", 
      RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"globalSegmentation", "@", "#"}]}], ")"}], "&"}], ",", 
        "imagesFiltered"}], "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "imagesFiltered"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.9277286065580587`*^9, 3.927728668549262*^9}, 
   3.927729086938004*^9, {3.9303910332622557`*^9, 3.9303910340283623`*^9}, {
   3.9306660969013543`*^9, 3.9306660989958267`*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"9f2dc80d-c438-4c69-9735-33661bad67ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ Preview Results ]]", "Subsection",
 CellChangeTimes->{{3.8931423053858385`*^9, 3.8931423475374203`*^9}, 
   3.900090717393674*^9, {3.9059694860785613`*^9, 3.905969488834731*^9}, {
   3.9277268222215295`*^9, 3.9277268283859863`*^9}, {3.927729106338478*^9, 
   3.9277291120879292`*^9}},
 FontSize->24,ExpressionUUID->"585d7f72-a62c-4470-baf2-ac93e4da789d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viewImage", "@", 
     RowBox[{"rotateImage", "@", 
      RowBox[{"imagesFiltered", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"Length", "@", "particleMasks"}], ",", "1"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"viewImage", "@", 
    RowBox[{"rotateImage", "@", 
     RowBox[{"particleMasks", "[", 
      RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "particleMasks"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.927872818681636*^9, 3.927872822307295*^9}, 
   3.927894847380559*^9, {3.927895139628892*^9, 3.9278951433067517`*^9}, {
   3.93039288144419*^9, 3.9303928824504986`*^9}, {3.9304064567510386`*^9, 
   3.9304064578821077`*^9}, 3.930543430504421*^9, 3.9305436601644835`*^9, {
   3.9306661055185995`*^9, 3.930666107787523*^9}},
 CellLabel->
  "In[373]:=",ExpressionUUID->"77c9f72f-c833-4135-80df-700bc0b7cfd4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Filtered Images & Particle Masks >>", "Subsection",
 CellChangeTimes->{{3.8931423053858385`*^9, 3.8931423475374203`*^9}, 
   3.900090717393674*^9, {3.9059694860785613`*^9, 3.905969488834731*^9}, {
   3.9277268222215295`*^9, 3.9277268283859863`*^9}, {3.927729106338478*^9, 
   3.9277291120879292`*^9}, {3.927729609210041*^9, 3.9277296364846554`*^9}},
 FontSize->24,ExpressionUUID->"c94a71ac-700b-4d85-8a54-6f3ad7533b11"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filteredImagesFolder", "=", 
   RowBox[{"output", "<>", "\"\<2 Filtered Images\>\""}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"filteredImagesFolder", "//", "CreateDirectory"}], ";"}], "//", 
   "Quiet"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exportImageSequence", "[", "\[IndentingNewLine]", 
     RowBox[{
     "imagesFiltered", ",", "filteredImagesFolder", ",", "\"\<.tiff\>\"", ",",
       "0"}], "\[IndentingNewLine]", "]"}], ";"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filteredImagesFolder", "=", 
   RowBox[{"output", "<>", "\"\<2 Filtered Images Compressed\>\""}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"filteredImagesFolder", "//", "CreateDirectory"}], ";"}], "//", 
  "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"imagesFilteredCompressed", "=", 
     RowBox[{
      RowBox[{"Compress", "/@", "imagesFiltered"}], "//", "Parallelize"}]}], 
    ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exportImageSequence", "[", "\[IndentingNewLine]", 
     RowBox[{
     "imagesFilteredCompressed", ",", "filteredImagesFolder", ",", 
      "\"\<.txt\>\"", ",", "1"}], "\[IndentingNewLine]", "]"}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"particleMasksFolder", "=", 
   RowBox[{"output", "<>", "\"\<3 Particle Masks\>\""}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"particleMasksFolder", "//", "CreateDirectory"}], ";"}], "//", 
   "Quiet"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exportImageSequence", "[", "\[IndentingNewLine]", 
     RowBox[{
     "particleMasks", ",", "particleMasksFolder", ",", "\"\<.tiff\>\"", ",", 
      "0"}], "\[IndentingNewLine]", "]"}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"particleMasksFolder", "=", 
   RowBox[{"output", "<>", "\"\<3 Particle Masks Compressed\>\""}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"particleMasksFolder", "//", "CreateDirectory"}], ";"}], "//", 
  "Quiet"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"particleMasksCompressed", "=", 
     RowBox[{
      RowBox[{"Compress", "/@", "particleMasks"}], "//", "Parallelize"}]}], 
    ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exportImageSequence", "[", "\[IndentingNewLine]", 
     RowBox[{
     "particleMasksCompressed", ",", "particleMasksFolder", ",", 
      "\"\<.txt\>\"", ",", "1"}], "\[IndentingNewLine]", "]"}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{"{", 
     RowBox[{"imagesFilteredCompressed", ",", "particleMasksCompressed"}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.8892817493431044`*^9, 3.8892817805519447`*^9}, {
   3.889281837143244*^9, 3.88928191320846*^9}, {3.8892819594009056`*^9, 
   3.889281979209507*^9}, {3.8892821229194517`*^9, 3.8892821513839016`*^9}, {
   3.889621126101282*^9, 3.8896211918063293`*^9}, 3.8896214994948688`*^9, {
   3.8896215537218475`*^9, 3.889621561789811*^9}, {3.8896216430248423`*^9, 
   3.8896216457023907`*^9}, 3.8896216789445276`*^9, {3.8896220419612627`*^9, 
   3.8896220975531425`*^9}, {3.889623340867552*^9, 3.8896233411228905`*^9}, {
   3.8899819697164917`*^9, 3.889981979009638*^9}, 3.889982019469488*^9, {
   3.8899820760598574`*^9, 3.8899820783107395`*^9}, {3.890046229067525*^9, 
   3.890046277931983*^9}, {3.890527335932677*^9, 3.8905273362291927`*^9}, {
   3.899494914195033*^9, 3.8994949154990673`*^9}, {3.9152225301919775`*^9, 
   3.915222534823679*^9}, {3.9152225847640715`*^9, 3.9152226171491485`*^9}, {
   3.915223424822422*^9, 3.915223436343696*^9}, {3.9152234753578963`*^9, 
   3.915223478397222*^9}, {3.9152235935791206`*^9, 3.915223594570014*^9}, {
   3.915226334078206*^9, 3.9152263746314983`*^9}, {3.9156276078247695`*^9, 
   3.9156276080076075`*^9}, {3.927729684808256*^9, 3.927729697436305*^9}, {
   3.927729802114377*^9, 3.9277298590646677`*^9}, {3.9277410637728114`*^9, 
   3.9277410752551756`*^9}, {3.927741136298992*^9, 3.927741214457574*^9}, {
   3.927741326971627*^9, 3.9277413375909023`*^9}, {3.927784153246481*^9, 
   3.9277841657672977`*^9}, 3.930665197513455*^9, {3.9306661192040124`*^9, 
   3.93066612017342*^9}},
 CellLabel->
  "In[382]:=",ExpressionUUID->"9f572ed9-b232-4912-9725-137a535f2b45"]
}, Open  ]],

Cell[CellGroupData[{

Cell[">> Import Compressed Filtered Images <<", "Subsection",
 CellChangeTimes->{{3.8931423053858385`*^9, 3.8931423475374203`*^9}, 
   3.900090717393674*^9, {3.9059694860785613`*^9, 3.905969488834731*^9}, {
   3.9277268222215295`*^9, 3.9277268283859863`*^9}, {3.927729106338478*^9, 
   3.9277291120879292`*^9}, {3.927729609210041*^9, 3.9277296364846554`*^9}, {
   3.927729793648041*^9, 3.927729796935981*^9}, {3.927731480048602*^9, 
   3.9277314815103827`*^9}, {3.927741046313405*^9, 3.92774104967412*^9}},
 FontSize->24,ExpressionUUID->"10f1439d-d06b-4628-8734-1bb5dfd836a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filteredImagesFolder", "=", 
   RowBox[{"output", "<>", "\"\<2 Filtered Images Compressed\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "@", "filteredImagesFolder"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"imagesFiltered", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"Uncompress", "@", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "filteredImagesFolder", "<>", "$PathnameSeparator", "<>", "#"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], ",", "files"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896225359098797`*^9, 3.8896226218372874`*^9}, {3.88962271829244*^9, 
   3.8896227275498905`*^9}, {3.889623134636578*^9, 3.889623137861703*^9}, {
   3.889623351635437*^9, 3.889623352090786*^9}, {3.8896235050986195`*^9, 
   3.889623534803034*^9}, 3.8899815513595295`*^9, {3.8901546653652105`*^9, 
   3.890154666131366*^9}, {3.8903837878670807`*^9, 3.8903837896332626`*^9}, {
   3.8903838511865406`*^9, 3.890383858398181*^9}, 3.8903839043715124`*^9, {
   3.890384135310108*^9, 3.890384146650017*^9}, {3.890386917039728*^9, 
   3.8903869187284775`*^9}, {3.8904093272504597`*^9, 3.890409333525776*^9}, 
   3.890409366183757*^9, {3.890527338154413*^9, 3.8905273383735204`*^9}, {
   3.8988782099719763`*^9, 3.8988782104193707`*^9}, {3.900093179450349*^9, 
   3.9000932064248447`*^9}, {3.9152226218831253`*^9, 3.915222649675064*^9}, {
   3.9152234558563757`*^9, 3.915223457637218*^9}, {3.9152264040897427`*^9, 
   3.9152264238564825`*^9}, {3.915226696268087*^9, 3.9152266970928*^9}, {
   3.915623639142209*^9, 3.9156236478696947`*^9}, {3.915627606721238*^9, 
   3.9156276069032154`*^9}, {3.927731117456588*^9, 3.927731135844578*^9}, {
   3.9277314623203983`*^9, 3.9277314624399*^9}, 3.9277315769358006`*^9, {
   3.9277414140565357`*^9, 3.927741425544236*^9}, 3.9303942318770504`*^9, {
   3.9306652106385026`*^9, 3.930665212902362*^9}},
 CellLabel->
  "In[399]:=",ExpressionUUID->"bace1d2f-9912-431e-a575-c159c5d7f6e2"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"viewImage", "@", 
    RowBox[{"rotateImage", "@", 
     RowBox[{"(*", 
      RowBox[{"ColorToneMapping", "@"}], "*)"}], 
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"imagesFiltered", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "imagesFiltered"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.930668290939847*^9, 3.930668291490842*^9}},
 CellLabel->
  "In[405]:=",ExpressionUUID->"80528cf7-9717-4910-9ecc-01ddf07f5d50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[">> Import Compressed Particle Masks <<", "Subsection",
 CellChangeTimes->{{3.8931423053858385`*^9, 3.8931423475374203`*^9}, 
   3.900090717393674*^9, {3.9059694860785613`*^9, 3.905969488834731*^9}, {
   3.9277268222215295`*^9, 3.9277268283859863`*^9}, {3.927729106338478*^9, 
   3.9277291120879292`*^9}, {3.927729609210041*^9, 3.9277296364846554`*^9}, {
   3.927729793648041*^9, 3.927729796935981*^9}, {3.927731480048602*^9, 
   3.9277314920230026`*^9}, {3.9277410525538883`*^9, 3.9277410533693523`*^9}},
 FontSize->24,ExpressionUUID->"8edf4ec1-ae64-4eaa-8e44-fdbb864da6fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"particleMasksFolder", "=", 
   RowBox[{"output", "<>", "\"\<3 Particle Masks Compressed\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "@", "particleMasksFolder"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"particleMasks", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"Uncompress", "@", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "particleMasksFolder", "<>", "$PathnameSeparator", "<>", "#"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], ",", "files"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896225359098797`*^9, 3.8896226218372874`*^9}, {3.88962271829244*^9, 
   3.8896227275498905`*^9}, {3.889623134636578*^9, 3.889623137861703*^9}, {
   3.889623351635437*^9, 3.889623352090786*^9}, {3.8896235050986195`*^9, 
   3.889623534803034*^9}, 3.8899815513595295`*^9, {3.8901546653652105`*^9, 
   3.890154666131366*^9}, {3.8903837878670807`*^9, 3.8903837896332626`*^9}, {
   3.8903838511865406`*^9, 3.890383858398181*^9}, 3.8903839043715124`*^9, {
   3.890384135310108*^9, 3.890384146650017*^9}, {3.890386917039728*^9, 
   3.8903869187284775`*^9}, {3.8904093272504597`*^9, 3.890409333525776*^9}, 
   3.890409366183757*^9, {3.890527338154413*^9, 3.8905273383735204`*^9}, {
   3.8988782099719763`*^9, 3.8988782104193707`*^9}, {3.900093179450349*^9, 
   3.9000932064248447`*^9}, {3.9152226218831253`*^9, 3.915222649675064*^9}, {
   3.9152234558563757`*^9, 3.915223457637218*^9}, {3.9152264040897427`*^9, 
   3.9152264238564825`*^9}, {3.915226696268087*^9, 3.9152266970928*^9}, {
   3.915623639142209*^9, 3.9156236478696947`*^9}, {3.915627606721238*^9, 
   3.9156276069032154`*^9}, {3.927731117456588*^9, 3.927731135844578*^9}, {
   3.9277314623203983`*^9, 3.9277314624399*^9}, {3.9277315904570546`*^9, 
   3.927731623074216*^9}, {3.927741460352473*^9, 3.9277414707530174`*^9}, 
   3.930394228294418*^9, {3.93066521928605*^9, 3.9306652218827157`*^9}},
 CellLabel->
  "In[406]:=",ExpressionUUID->"cbb198de-97e6-4825-925a-b10563bbcd6e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particle Coordinates & Data for Tracking", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.842969150048052*^9, 3.8429691537910447`*^9}, {3.8615435122762966`*^9, 
  3.861543517725723*^9}, {3.890209056062702*^9, 3.89020905769811*^9}, {
  3.927782772774294*^9, 
  3.927782779614051*^9}},ExpressionUUID->"73b84d3b-bd4b-4cb3-8cb8-\
be4287d95d0a"],

Cell[CellGroupData[{

Cell["Get Particle Coordinates", "Subsection",
 CellChangeTimes->{{3.8931423053858385`*^9, 3.8931423475374203`*^9}, 
   3.900090717393674*^9, {3.9059694860785613`*^9, 3.905969488834731*^9}, {
   3.9277268222215295`*^9, 3.9277268283859863`*^9}, {3.927729106338478*^9, 
   3.9277291120879292`*^9}, {3.927729609210041*^9, 3.9277296364846554`*^9}, {
   3.927729793648041*^9, 3.927729796935981*^9}, {3.927731480048602*^9, 
   3.9277314920230026`*^9}, {3.9277410525538883`*^9, 
   3.9277410533693523`*^9}, {3.9277827864465017`*^9, 3.927782791261283*^9}},
 FontSize->24,ExpressionUUID->"0ef7c46a-e15b-47b1-b6c4-3609792e9d0f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"particleCentroids", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"(", 
            RowBox[{"Last", "/@", 
             RowBox[{"ComponentMeasurements", "[", 
              RowBox[{"#", ",", "\"\<Centroid\>\""}], "]"}]}], ")"}]}], 
          "\[IndentingNewLine]", ")"}], "&"}], "/@", "particleMasks"}], "//", 
       "Parallelize"}]}], ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "particleMasks"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.9277827984366484`*^9, 3.9277829929872055`*^9}, {
  3.927784910382248*^9, 3.9277849199837627`*^9}, {3.930393072703551*^9, 
  3.930393077371252*^9}},
 CellLabel->
  "In[412]:=",ExpressionUUID->"8afa99b8-1399-4746-a9b9-f1bfbf7a44b7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Length", "/@", "particleCentroids"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"getLatexStyling", "/@", 
       RowBox[{"{", 
        RowBox[{"\"\<t\>\"", ",", "\"\<N\>\""}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"rotateImage", "@", 
          RowBox[{"HighlightImage", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"particleCentroids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", 
              RowBox[{"PointSize", "@", "0.005"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
        RowBox[{"getMaskOverlays", "[", 
         RowBox[{"#", ",", "channelWallMask", ",", "White", ",", "2"}], 
         "]"}]}], "&"}], "@", 
      RowBox[{"imagesFiltered", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "@", "particleCentroids"}], ",", "1"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9277827984366484`*^9, 3.9277829929872055`*^9}, {
   3.927784910382248*^9, 3.9277849199837627`*^9}, {3.930393072703551*^9, 
   3.930393077371252*^9}, 
   3.930676323840228*^9},ExpressionUUID->"7c9a6804-5fd2-45fa-ac6f-\
dc051bac4b77"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Particle Coordinates >>", "Subsection",
 CellChangeTimes->{{3.8931423053858385`*^9, 3.8931423475374203`*^9}, 
   3.900090717393674*^9, {3.9059694860785613`*^9, 3.905969488834731*^9}, {
   3.9277268222215295`*^9, 3.9277268283859863`*^9}, {3.927729106338478*^9, 
   3.9277291120879292`*^9}, {3.927729609210041*^9, 3.9277296364846554`*^9}, {
   3.927729793648041*^9, 3.927729796935981*^9}, {3.927731480048602*^9, 
   3.9277314920230026`*^9}, {3.9277410525538883`*^9, 
   3.9277410533693523`*^9}, {3.9277827864465017`*^9, 3.927782791261283*^9}, {
   3.927784010125972*^9, 3.9277840331263714`*^9}},
 FontSize->24,ExpressionUUID->"02fb0dc3-6d4a-42e3-96eb-28475fc36140"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\n", 
   RowBox[{
    RowBox[{
    "dataCompressedfolder", "<>", "$PathnameSeparator", "<>", 
     "\"\<Particle Centroids.txt\>\""}], ",", "\n", 
    RowBox[{"Compress", "@", "particleCentroids"}]}], "\n", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9277840345852766`*^9, 3.927784062483907*^9}, {
  3.9306731540258083`*^9, 3.930673157528391*^9}},
 CellLabel->
  "In[441]:=",ExpressionUUID->"fd72cf3d-32c0-4858-93a7-9eb1e620c5c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[">> Import Particle Coordinates <<", "Subsection",
 CellChangeTimes->{{3.8931423053858385`*^9, 3.8931423475374203`*^9}, 
   3.900090717393674*^9, {3.9059694860785613`*^9, 3.905969488834731*^9}, {
   3.9277268222215295`*^9, 3.9277268283859863`*^9}, {3.927729106338478*^9, 
   3.9277291120879292`*^9}, {3.927729609210041*^9, 3.9277296364846554`*^9}, {
   3.927729793648041*^9, 3.927729796935981*^9}, {3.927731480048602*^9, 
   3.9277314920230026`*^9}, {3.9277410525538883`*^9, 
   3.9277410533693523`*^9}, {3.9277827864465017`*^9, 3.927782791261283*^9}, {
   3.927784010125972*^9, 3.9277840446051536`*^9}},
 FontSize->24,ExpressionUUID->"39f68dff-bb23-4d22-ac22-d437d6618563"],

Cell[BoxData[
 RowBox[{
  RowBox[{"particleCentroids", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{"dataCompressedfolder", "<>", "\"\<Particle Centroids.txt\>\""}],
      "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9277840659903116`*^9, 3.927784069799634*^9}, 
   3.930394246937713*^9, 
   3.9306763335805893`*^9},ExpressionUUID->"aeb8106c-a362-4bd5-983b-\
ff906ae1e130"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export Notebook With Parameters", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.842969150048052*^9, 3.8429691537910447`*^9}, {3.8615435122762966`*^9, 
  3.861543517725723*^9}, {3.890209056062702*^9, 
  3.89020905769811*^9}},ExpressionUUID->"c090ae3e-8ce3-494b-9d40-\
6dbc800c7b9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"notebookID", "=", "1"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookSave", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"notebookSnapshot", "=", 
    RowBox[{"NotebookOpen", "@", 
     RowBox[{"NotebookFileName", "[", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"output", "<>", 
        RowBox[{"Last", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"#", ",", "$PathnameSeparator"}], "]"}]}]}], "&"}], "@", 
      "output"}], "<>", "\"\<_Run_\>\"", "<>", 
     RowBox[{"ToString", "@", "notebookID"}], "<>", "\"\<.pdf\>\""}], ",", 
    "notebookSnapshot"}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.861543175536664*^9, 3.8615432357785387`*^9}, {
   3.86154342636442*^9, 3.861543447540553*^9}, {3.861543590796198*^9, 
   3.8615435924374075`*^9}, {3.861798817780515*^9, 3.861798818319141*^9}, {
   3.88928857082766*^9, 3.8892885935714035`*^9}, {3.889300824400525*^9, 
   3.889300826019042*^9}, {3.8900794555092363`*^9, 3.8900794592661676`*^9}, 
   3.8902083844570394`*^9, 3.890209069048913*^9, 3.8902093067789917`*^9, {
   3.8905940957431183`*^9, 3.890594096652687*^9}, 3.8905942440505*^9, {
   3.8941325023793926`*^9, 3.8941325032889395`*^9}, {3.89469919779359*^9, 
   3.894699197823932*^9}, {3.8947136469968*^9, 3.8947136482268553`*^9}, 
   3.8948274270813093`*^9, 3.8948275185738883`*^9, 3.896442076226533*^9, 
   3.9100898814482017`*^9, 3.910425786437649*^9, 3.9126150068030386`*^9, 
   3.912688067441677*^9, {3.912689997393589*^9, 3.912689998663714*^9}, 
   3.915226205688525*^9, 3.915645567121797*^9},
 CellLabel->
  "In[437]:=",ExpressionUUID->"3fbbfd4b-c78a-4ced-b523-c16fb5bb4f2c"]
}, Open  ]]
},
WindowSize->{766.8, 795.5999999999999},
WindowMargins->{{-4.8, Automatic}, {Automatic, 0}},
TaggingRules->{"TryRealOnly" -> False},
Magnification:>0.95,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 9, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f2e15281-8296-4651-89aa-e094a2317cc0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 380, 8, 73, "Item",ExpressionUUID->"893d54b5-4445-478c-a18d-2e20b9f448e6"],
Cell[963, 32, 217, 4, 31, "Item",ExpressionUUID->"1a0daef4-1570-453b-8368-2494e448c791"],
Cell[1183, 38, 238, 4, 31, "Item",ExpressionUUID->"2e1de900-b2f1-4da6-9582-6e5dc56ff84c"],
Cell[1424, 44, 241, 4, 31, "Item",ExpressionUUID->"514f196c-f212-468c-9aab-071db8706a6a"],
Cell[1668, 50, 235, 4, 31, "Item",ExpressionUUID->"1f362166-2180-4ddb-a4af-4aa6f3003502"]
}, Open  ]],
Cell[1918, 57, 159, 3, 26, "Input",ExpressionUUID->"80d80720-de6d-4268-b533-6b474d6cba92"],
Cell[2080, 62, 1043, 20, 242, "Abstract",ExpressionUUID->"ef232dc1-b114-482f-a7d2-7734aeca2543"],
Cell[3126, 84, 331, 5, 68, "Abstract",ExpressionUUID->"f6b308f5-3e53-4055-b95c-362832c65f61"],
Cell[CellGroupData[{
Cell[3482, 93, 591, 9, 63, "Section",ExpressionUUID->"0a7902ba-3100-4679-9380-02b3076e63e9"],
Cell[4076, 104, 10004, 218, 1248, "Input",ExpressionUUID->"ab188b0e-0b8c-4d83-8dbe-6e47cf17a532",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[14117, 327, 564, 8, 50, "Section",ExpressionUUID->"80fd0985-c1c7-4fcd-9f0d-048ce9507304"],
Cell[14684, 337, 662, 14, 174, "Abstract",ExpressionUUID->"62616898-1dc0-4674-bcc3-c99a4164e76f"],
Cell[15349, 353, 11826, 183, 294, "Input",ExpressionUUID->"f2df995a-561c-4dcc-83ed-057b4b0b65b1",
 InitializationCell->True],
Cell[27178, 538, 446, 10, 128, "Abstract",ExpressionUUID->"aeba573c-23b2-4025-851e-0f311304801d"],
Cell[27627, 550, 13876, 224, 438, "Input",ExpressionUUID->"29f4f347-5bc7-411b-a743-fef79f040a60",
 InitializationCell->True],
Cell[41506, 776, 2134, 49, 243, "Input",ExpressionUUID->"a4efabc0-6431-4664-b053-de608be82619"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43677, 830, 517, 8, 63, "Section",ExpressionUUID->"a6c1a855-d2ce-4ce7-8e77-3002edfcfd56"],
Cell[44197, 840, 330, 4, 68, "Abstract",ExpressionUUID->"8a8ace1e-91d8-44d1-814b-518b0d9b29f6"],
Cell[CellGroupData[{
Cell[44552, 848, 192, 2, 55, "Subsection",ExpressionUUID->"0e5b0001-b41e-4467-b3f9-0da9893d8598"],
Cell[44747, 852, 13299, 289, 996, "Input",ExpressionUUID->"beaec6fc-29f0-4523-aef2-66cb9807b124",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[58083, 1146, 503, 7, 40, "Subsection",ExpressionUUID->"8030b3f9-704c-4f14-a34c-1c106b3f9c9a"],
Cell[58589, 1155, 10378, 177, 726, "Input",ExpressionUUID->"25de1078-bc4a-4399-9c4b-3250768822a8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[69004, 1337, 516, 7, 40, "Subsection",ExpressionUUID->"79f94e50-5c8b-4fab-b397-bdcb801b3455"],
Cell[69523, 1346, 5569, 93, 168, "Input",ExpressionUUID->"ae9e466b-1b82-4bc9-8437-553d8b171e20",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75141, 1445, 665, 10, 63, "Section",ExpressionUUID->"6f2a1bc0-34e9-4b61-a42e-db38886ab52b"],
Cell[75809, 1457, 577, 12, 128, "Abstract",ExpressionUUID->"70a7e316-d568-4003-93b0-4e5d38523426"],
Cell[76389, 1471, 663, 13, 60, "Input",ExpressionUUID->"342563f0-589e-42ec-965b-36366f32c18a",
 InitializationCell->True],
Cell[77055, 1486, 1305, 27, 117, "Input",ExpressionUUID->"1ea10bda-d7ad-42b8-b0e4-58111a06e837"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78397, 1518, 204, 4, 63, "Section",ExpressionUUID->"6233e718-0804-4d1a-8f9a-abf48485703c"],
Cell[CellGroupData[{
Cell[78626, 1526, 799, 11, 55, "Subsection",ExpressionUUID->"04fe44c9-dd63-4913-9b0e-c423827ea7e6"],
Cell[CellGroupData[{
Cell[79450, 1541, 174, 3, 42, "Subsubsection",ExpressionUUID->"226725fa-b137-4e13-8452-83effc76d73c"],
Cell[79627, 1546, 683, 13, 105, "Abstract",ExpressionUUID->"ea9edec7-9869-4ebf-9070-755d668f86d3"],
Cell[80313, 1561, 707, 13, 41, "Input",ExpressionUUID->"afa39e2d-a25c-430f-9c9c-d0ed406d5972",
 InitializationCell->True],
Cell[81023, 1576, 5438, 108, 549, "Input",ExpressionUUID->"b3029616-4ce4-4f1b-8de2-267d5d39b5da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86498, 1689, 164, 3, 42, "Subsubsection",ExpressionUUID->"f77be009-3cc1-4a17-bc70-2a7a48245b50"],
Cell[86665, 1694, 943, 19, 197, "Abstract",ExpressionUUID->"17396fb9-0d83-4217-acfa-067fd7eec6f2"],
Cell[87611, 1715, 982, 24, 60, "Input",ExpressionUUID->"f314ec14-7bf0-4a77-bdc4-1ade4f97a4aa",
 InitializationCell->True],
Cell[88596, 1741, 2116, 46, 189, "Input",ExpressionUUID->"ab2fdad6-c23c-49da-95bb-dfaa9280f20f"],
Cell[90715, 1789, 653, 12, 105, "Abstract",ExpressionUUID->"c66e71a4-d2c4-468e-a64d-6df5da6dcbf3"],
Cell[91371, 1803, 1405, 22, 41, "Input",ExpressionUUID->"c3cc8725-ff6e-4d39-bc5e-7065d8b6a093",
 InitializationCell->True],
Cell[92779, 1827, 1144, 26, 81, "Input",ExpressionUUID->"a922cb99-7c34-47d2-ae7f-5811cc56be34"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93972, 1859, 818, 11, 55, "Subsection",ExpressionUUID->"213b0299-69a4-47de-9aa0-bf3381e13be8"],
Cell[94793, 1872, 1974, 35, 117, "Input",ExpressionUUID->"3a9849a7-b51c-450d-be47-5c64c31fc2bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96804, 1912, 816, 11, 55, "Subsection",ExpressionUUID->"42bb92d9-9ad1-4eb1-9e75-7865bb3018ff"],
Cell[97623, 1925, 3218, 68, 351, "Input",ExpressionUUID->"f0d4fad0-94ea-42de-845a-7b8ffdcce6e1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100890, 1999, 725, 10, 63, "Section",ExpressionUUID->"5755cac6-3b25-4282-a496-56b79914411f"],
Cell[CellGroupData[{
Cell[101640, 2013, 778, 10, 55, "Subsection",ExpressionUUID->"490656a1-7045-4adf-b8e6-76f1cabd2196"],
Cell[102421, 2025, 670, 14, 151, "Abstract",ExpressionUUID->"cfe5cba0-beef-4b11-8d7d-6683aa2e812d"],
Cell[103094, 2041, 1522, 26, 78, "Input",ExpressionUUID->"a552173d-c230-4776-9277-63c03c42bb2e",
 InitializationCell->True],
Cell[104619, 2069, 3405, 75, 207, "Input",ExpressionUUID->"cf94c8d2-4c96-4099-bebf-978587dcc2a1"],
Cell[108027, 2146, 670, 13, 128, "Abstract",ExpressionUUID->"eaad9514-e84a-4d37-b736-52e6dfaba045"],
Cell[108700, 2161, 703, 13, 60, "Input",ExpressionUUID->"b77e48b2-9012-4595-937f-e896bbc330c8",
 InitializationCell->True],
Cell[109406, 2176, 2461, 47, 135, "Input",ExpressionUUID->"5dd480a7-9bca-408d-a303-24860a5e2a8d"],
Cell[111870, 2225, 987, 23, 171, "Input",ExpressionUUID->"618dcf84-9348-40fc-ae54-deccf99e2127"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112894, 2253, 827, 11, 55, "Subsection",ExpressionUUID->"92f15eaf-a101-403e-91cc-cc4d39fd36a3"],
Cell[113724, 2266, 1901, 49, 207, "Input",ExpressionUUID->"30ba6f68-d213-4e5e-a796-e52afca196a1"],
Cell[115628, 2317, 642, 14, 81, "Input",ExpressionUUID->"b96a810a-d871-4055-a0ab-a06d53681d72"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116307, 2336, 1020, 13, 55, "Subsection",ExpressionUUID->"3ac51f76-07b5-4bd6-9a88-7ef3ccaa09d1"],
Cell[117330, 2351, 997, 18, 151, "Abstract",ExpressionUUID->"9c07c24f-33b4-4628-a0ee-b2e176009d32"],
Cell[118330, 2371, 3456, 52, 96, "Input",ExpressionUUID->"24cdcf28-37c7-494f-a812-320be3d4af8c",
 InitializationCell->True],
Cell[121789, 2425, 4975, 95, 261, "Input",ExpressionUUID->"be06836d-a594-4699-9bfc-98b6d95782b5"],
Cell[126767, 2522, 1005, 20, 81, "Input",ExpressionUUID->"31c26922-8cad-4617-a5de-3cde4d9dc6d1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127821, 2548, 774, 11, 63, "Section",ExpressionUUID->"a4feb96b-f813-4ed0-9703-152c70302f67"],
Cell[CellGroupData[{
Cell[128620, 2563, 1117, 15, 55, "Subsection",ExpressionUUID->"a3fac260-2ed5-4503-8004-b720b157dff1"],
Cell[129740, 2580, 1222, 23, 310, "Abstract",ExpressionUUID->"d17ca023-bef5-4aac-9f61-adbe1ff0ebfd"],
Cell[130965, 2605, 1179, 24, 265, "Abstract",ExpressionUUID->"eba4f223-c78c-4207-a181-fd2801ca4e7f"],
Cell[132147, 2631, 2878, 49, 168, "Input",ExpressionUUID->"a68eba93-21c3-4254-b9f6-4963fc58d6e5",
 InitializationCell->True],
Cell[135028, 2682, 4785, 105, 423, "Input",ExpressionUUID->"da6d1574-3c17-44c8-8cfa-ec0bd93f9f2b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139850, 2792, 1225, 16, 55, "Subsection",ExpressionUUID->"652f9cac-fbc4-4212-a647-86c11a64a361"],
Cell[141078, 2810, 1127, 27, 117, "Input",ExpressionUUID->"982d9c6c-e2fc-4d32-bced-d9a15f201654"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142242, 2842, 1065, 14, 55, "Subsection",ExpressionUUID->"d3e4c591-b0d4-40e6-834d-4ebca51b6842"],
Cell[143310, 2858, 770, 14, 161, "Abstract",ExpressionUUID->"1277bdf1-5777-40ac-97a0-cf1746ced3bd"],
Cell[144083, 2874, 1284, 29, 356, "Abstract",ExpressionUUID->"3595dfbb-7a52-446b-ae63-d69855757ebc"],
Cell[145370, 2905, 6686, 107, 240, "Input",ExpressionUUID->"6ff959a9-4e3a-42a8-b33c-cc8abb9cdc9a",
 InitializationCell->True],
Cell[152059, 3014, 1039, 18, 128, "Abstract",ExpressionUUID->"4cced035-5b09-4a3d-91fd-217c18fe5360"],
Cell[153101, 3034, 8804, 179, 531, "Input",ExpressionUUID->"5b964cba-d1c3-4a96-b069-5d1586ad271e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161942, 3218, 353, 5, 55, "Subsection",ExpressionUUID->"5ddb74a0-d46e-474d-9a1a-9fc13d2d2c29"],
Cell[162298, 3225, 1880, 49, 279, "Input",ExpressionUUID->"9f2dc80d-c438-4c69-9735-33661bad67ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164215, 3279, 363, 5, 55, "Subsection",ExpressionUUID->"585d7f72-a62c-4470-baf2-ac93e4da789d"],
Cell[164581, 3286, 1272, 28, 171, "Input",ExpressionUUID->"77c9f72f-c833-4135-80df-700bc0b7cfd4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165890, 3319, 435, 5, 55, "Subsection",ExpressionUUID->"c94a71ac-700b-4d85-8a54-6f3ad7533b11"],
Cell[166328, 3326, 4832, 110, 603, "Input",ExpressionUUID->"9f572ed9-b232-4912-9725-137a535f2b45"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171197, 3441, 576, 7, 55, "Subsection",ExpressionUUID->"10f1439d-d06b-4628-8734-1bb5dfd836a0"],
Cell[171776, 3450, 3353, 70, 351, "Input",ExpressionUUID->"bace1d2f-9912-431e-a575-c159c5d7f6e2"],
Cell[175132, 3522, 666, 16, 81, "Input",ExpressionUUID->"80528cf7-9717-4910-9ecc-01ddf07f5d50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175835, 3543, 580, 7, 55, "Subsection",ExpressionUUID->"8edf4ec1-ae64-4eaa-8e44-fdbb864da6fb"],
Cell[176418, 3552, 3369, 70, 351, "Input",ExpressionUUID->"cbb198de-97e6-4825-925a-b10563bbcd6e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[179836, 3628, 680, 10, 63, "Section",ExpressionUUID->"73b84d3b-bd4b-4cb3-8cb8-be4287d95d0a"],
Cell[CellGroupData[{
Cell[180541, 3642, 618, 8, 55, "Subsection",ExpressionUUID->"0ef7c46a-e15b-47b1-b6c4-3609792e9d0f"],
Cell[181162, 3652, 1177, 30, 153, "Input",ExpressionUUID->"8afa99b8-1399-4746-a9b9-f1bfbf7a44b7"],
Cell[182342, 3684, 1579, 39, 171, "Input",ExpressionUUID->"7c9a6804-5fd2-45fa-ac6f-dc051bac4b77"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183958, 3728, 679, 9, 55, "Subsection",ExpressionUUID->"02fb0dc3-6d4a-42e3-96eb-28475fc36140"],
Cell[184640, 3739, 485, 12, 81, "Input",ExpressionUUID->"fd72cf3d-32c0-4858-93a7-9eb1e620c5c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185162, 3756, 679, 9, 55, "Subsection",ExpressionUUID->"39f68dff-bb23-4d22-ac22-d437d6618563"],
Cell[185844, 3767, 457, 10, 63, "Input",ExpressionUUID->"aeb8106c-a362-4bd5-983b-ff906ae1e130"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[186350, 3783, 622, 9, 63, "Section",ExpressionUUID->"c090ae3e-8ce3-494b-9d40-6dbc800c7b9c"],
Cell[186975, 3794, 2066, 45, 189, "Input",ExpressionUUID->"3fbbfd4b-c78a-4ced-b523-c16fb5bb4f2c"]
}, Open  ]]
}
]
*)

